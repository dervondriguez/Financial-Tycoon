<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Services Tycoon | Real-Time CEO Simulator</title>
    <link rel="stylesheet" href="./Financial Services Tycoon _ Real-Time CEO Simulator_files/all.min.css">
    <style>
        :root {
            --primary: #2c5282;
            --secondary: #4299e1;
            --accent: #ed8936;
            --success: #38a169;
            --warning: #d69e2e;
            --danger: #e53e3e;
            --light: #f7fafc;
            --dark: #1a202c;
            --glass: rgba(255, 255, 255, 0.15);
            --border: rgba(255, 255, 255, 0.25);
            --warm-bg: linear-gradient(135deg, #f8f5f0 0%, #e6f2ff 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-dark: #2d3748;
            --text-light: #4a5568;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, 'SF Pro Display', sans-serif;
        }

        body {
            background: var(--warm-bg);
            color: var(--text-dark);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            padding: 1rem 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 4px solid var(--accent);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .company-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .company-logo {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: var(--primary);
            border: 3px solid white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            overflow: hidden;
        }

        .company-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .company-name {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .company-name:hover {
            transform: translateY(-2px);
        }

        /* Real Time Display */
        .real-time-display {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.8rem 1.5rem;
            border-radius: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .time-display {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 1.1rem;
            color: white;
        }

        .tt-flag {
            font-size: 1.8rem;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }

        /* Save/Load/Reset Buttons */
        .save-load-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .save-btn, .load-btn, .reset-btn {
            padding: 0.6rem 1.2rem;
            border: 2px solid white;
            background: transparent;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .save-btn:hover, .load-btn:hover {
            background: white;
            color: var(--primary);
            transform: translateY(-2px);
        }

        .reset-btn:hover {
            background: white;
            color: var(--danger);
            transform: translateY(-2px);
        }

        /* Main Balance */
        .main-balance {
            text-align: center;
            padding: 2rem;
            margin: 1rem auto;
            max-width: 600px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            border: 2px solid #e2e8f0;
        }

        .balance-amount {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(90deg, var(--success), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin: 0.5rem 0;
            text-shadow: 0 2px 20px rgba(66, 153, 225, 0.2);
        }

        .balance-label {
            color: var(--text-light);
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 600;
        }

        /* Tabs Navigation */
        .tabs-container {
            max-width: 1400px;
            margin: 0 auto 2rem;
            padding: 0 1rem;
        }

        .tabs {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            padding: 0.5rem;
            scrollbar-width: thin;
            background: white;
            border-radius: 16px 16px 0 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .tabs::-webkit-scrollbar {
            height: 6px;
        }

        .tabs::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 3px;
        }

        .tab {
            padding: 1rem 1.8rem;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px 12px 0 0;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            color: var(--text-light);
            font-weight: 600;
        }

        .tab:hover {
            background: #edf2f7;
            border-color: var(--secondary);
            color: var(--secondary);
        }

        .tab.active {
            background: white;
            border-bottom-color: transparent;
            color: var(--primary);
            border-color: var(--secondary);
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.05);
        }

        .tab i {
            font-size: 1.2rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            background: white;
            border-radius: 0 16px 16px 16px;
            padding: 2rem;
            min-height: 500px;
            border: 2px solid #e2e8f0;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.05);
        }

        .tab-content.active {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards Grid */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .card {
            background: var(--card-bg);
            border: 2px solid #e2e8f0;
            border-radius: 18px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            border-color: var(--secondary);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f1f5f9;
        }

        .card-title {
            font-size: 1.3rem;
            color: var(--primary);
            font-weight: 700;
        }

        .card-icon {
            font-size: 2rem;
            color: var(--secondary);
        }

        .stats {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .stat-label {
            color: var(--text-light);
            font-weight: 500;
        }

        .stat-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .positive {
            color: var(--success);
        }

        .negative {
            color: var(--danger);
        }

        .neutral {
            color: var(--secondary);
        }

        /* Buttons */
        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0.3rem;
            font-size: 0.95rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background: linear-gradient(90deg, var(--secondary), #3182ce);
            color: white;
        }

        .btn-success {
            background: linear-gradient(90deg, var(--success), #2f855a);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(90deg, var(--warning), #d69e2e);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(90deg, var(--danger), #c53030);
            color: white;
        }

        .btn-accent {
            background: linear-gradient(90deg, var(--accent), #dd6b20);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Progress Bars */
        .progress-container {
            margin: 1rem 0;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            color: var(--text-light);
            font-weight: 500;
        }

        .progress-bar {
            height: 10px;
            background: #e2e8f0;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--secondary));
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        /* Notification System */
        .notification-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 400px;
        }

        .notification {
            background: white;
            border-left: 6px solid var(--secondary);
            padding: 1.2rem;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            animation: slideInRight 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
            border: 2px solid #e2e8f0;
        }

        .notification.success {
            border-left-color: var(--success);
        }

        .notification.warning {
            border-left-color: var(--warning);
        }

        .notification.danger {
            border-left-color: var(--danger);
        }

        .notification.info {
            border-left-color: var(--secondary);
        }

        .notification i {
            font-size: 1.5rem;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1001;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            border-radius: 24px;
            padding: 2.5rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid #e2e8f0;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.4s ease;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f1f5f9;
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 2rem;
            cursor: pointer;
            transition: color 0.3s;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-modal:hover {
            color: var(--danger);
            background: #fee;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.8rem;
            color: var(--primary);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .form-input {
            width: 100%;
            padding: 1rem;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            color: var(--text-dark);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--secondary);
            background: white;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }

        /* Game Cycle Display */
        .cycle-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 16px;
            margin: 1.5rem 0;
            border: 2px solid #e2e8f0;
        }

        .cycle-info {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .cycle-time {
            font-size: 1.8rem;
            color: var(--primary);
            font-weight: 700;
        }

        /* Financial Charts */
        .chart-container {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid #e2e8f0;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.05);
        }

        .chart-placeholder {
            height: 200px;
            background: linear-gradient(90deg, #f8fafc, #e6fffa);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            font-size: 1.2rem;
            border: 2px dashed #cbd5e0;
        }

        /* CEO Special Card */
        .ceo-card {
            border: 3px solid var(--accent);
            background: linear-gradient(135deg, #fffaf0, #fff5f5);
        }

        .ceo-card .card-title {
            color: var(--accent);
        }

        /* Staff Member Special Card */
        .staff-member-card {
            border: 3px solid #38a169;
            background: linear-gradient(135deg, #f0fff4, #e6fffa);
            position: relative;
        }

        .staff-member-card .card-title {
            color: var(--success);
        }

        .boost-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--success);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Loan Cards */
        .loan-card {
            border: 3px solid #805ad5;
            background: linear-gradient(135deg, #faf5ff, #e9d8fd);
        }

        .loan-card .card-title {
            color: #805ad5;
        }

        .loan-badge {
            display: inline-block;
            background: #805ad5;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 5px;
        }

        /* Staff Count Display */
        .staff-count {
            display: inline-block;
            background: var(--secondary);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            margin-left: 5px;
        }

        /* Actions Log */
        .actions-log-container {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid #e2e8f0;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.05);
        }

        .actions-log {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
            margin-top: 1rem;
        }

        .actions-log::-webkit-scrollbar {
            width: 8px;
        }

        .actions-log::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .actions-log::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 4px;
        }

        .action-entry {
            padding: 0.8rem 1rem;
            margin-bottom: 0.8rem;
            background: #f8fafc;
            border-radius: 10px;
            border-left: 4px solid var(--secondary);
            display: flex;
            align-items: center;
            gap: 0.8rem;
            animation: fadeIn 0.5s ease;
        }

        .action-entry.success {
            border-left-color: var(--success);
            background: #f0fff4;
        }

        .action-entry.warning {
            border-left-color: var(--warning);
            background: #fffaf0;
        }

        .action-entry.danger {
            border-left-color: var(--danger);
            background: #fff5f5;
        }

        .action-entry.info {
            border-left-color: var(--secondary);
            background: #f0f9ff;
        }

        .action-time {
            font-size: 0.8rem;
            color: var(--text-light);
            min-width: 80px;
        }

        .action-message {
            flex: 1;
        }

        .clear-log-btn {
            margin-top: 1rem;
            float: right;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .company-brand {
                justify-content: center;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .tab {
                flex: 1;
                min-width: 120px;
                justify-content: center;
                padding: 0.8rem 1rem;
            }

            .balance-amount {
                font-size: 2.5rem;
            }

            .cards-grid {
                grid-template-columns: 1fr;
            }

            .save-load-buttons {
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(66, 153, 225, 0.3);
            border-radius: 50%;
            border-top-color: var(--secondary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Customization Section */
        .customization-section {
            background: linear-gradient(135deg, #f0f9ff, #fefce8);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 2px dashed var(--secondary);
        }

        .logo-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            margin: 1rem 0;
        }

        .logo-preview {
            width: 120px;
            height: 120px;
            border-radius: 20px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: var(--primary);
            border: 3px solid var(--secondary);
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .logo-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Welcome Message */
        .welcome-message {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-radius: 20px;
            margin-bottom: 2rem;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        .welcome-message h2 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .welcome-message p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        /* Time Passed Display */
        .time-passed-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-light);
            background: #f8fafc;
            padding: 0.5rem 1rem;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }

        .time-passed-display span {
            font-weight: bold;
            color: var(--primary);
        }

        /* Contract Services Specific Styles */
        .contract-card {
            border: 3px solid #9f7aea;
            background: linear-gradient(135deg, #faf5ff, #e9d8fd);
            position: relative;
        }
        
        .contract-card .card-title {
            color: #805ad5;
        }
        
        .contract-badge {
            display: inline-block;
            background: #9f7aea;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 5px;
        }
        
        .contract-offer {
            background: #f0fff4;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            border: 2px solid #38a169;
        }
        
        .contract-client {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-weight: bold;
            color: #2d3748;
        }
        
        .contract-price {
            font-size: 1.3rem;
            font-weight: bold;
            color: #38a169;
            text-align: center;
            margin: 0.5rem 0;
        }
        
        .contract-timer {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin: 0.5rem 0;
            color: #4a5568;
            font-weight: 500;
        }
        
        .contract-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .availability-check {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }
        
        .availability-check.available {
            color: #38a169;
        }
        
        .availability-check.unavailable {
            color: #e53e3e;
        }
        
        /* Status indicators */
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        
        .status-active {
            background: #38a169;
        }
        
        .status-inactive {
            background: #e53e3e;
        }
        
        .status-waiting {
            background: #d69e2e;
        }
        
        .status-available {
            background: #4299e1;
        }
        
        /* Contract Progress Bar */
        .contract-progress {
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
            margin: 0.5rem 0;
        }
        
        .contract-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #38a169, #4299e1);
            border-radius: 3px;
            transition: width 1s linear;
        }
        
        /* Contract Modal */
        .contract-modal {
            max-width: 800px;
        }
        
        .contract-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .contract-details {
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
        }
        
        .requirements-list {
            list-style: none;
            padding: 0;
            margin: 1rem 0;
        }
        
        .requirements-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .requirements-list li:last-child {
            border-bottom: none;
        }
        
        .requirements-list i {
            font-size: 1.2rem;
        }
        
        .requirement-met {
            color: #38a169;
        }
        
        .requirement-not-met {
            color: #e53e3e;
        }
        
        /* Contract History */
        .contract-history {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 1rem;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }
        
        .history-entry {
            padding: 0.8rem;
            margin-bottom: 0.8rem;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #4299e1;
            font-size: 0.9rem;
        }
        
        .history-entry.success {
            border-left-color: #38a169;
            background: #f0fff4;
        }
        
        .history-entry.completed {
            border-left-color: #805ad5;
            background: #faf5ff;
        }
        
        .history-entry.rejected {
            border-left-color: #e53e3e;
            background: #fff5f5;
        }
        
        /* Staff Requirements Badge */
        .staff-req-badge {
            display: inline-block;
            background: #ed8936;
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 5px;
        }
        
        /* Staffing Warning */
        .staffing-warning {
            background: #fffaf0;
            border: 2px solid #d69e2e;
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .staffing-good {
            background: #f0fff4;
            border: 2px solid #38a169;
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        /* Loan Management Styles */
        .loan-management-container {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid #e2e8f0;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.05);
        }
        
        .loan-filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #e2e8f0;
            background: #f8fafc;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .loan-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 1rem;
        }
        
        .loan-item {
            padding: 1rem;
            margin-bottom: 0.8rem;
            background: #f8fafc;
            border-radius: 10px;
            border-left: 4px solid #4299e1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .loan-item.active {
            border-left-color: #38a169;
        }
        
        .loan-item.defaulted {
            border-left-color: #e53e3e;
        }
        
        .loan-item.paid {
            border-left-color: #805ad5;
            background: #faf5ff;
        }
        
        .loan-info {
            flex: 1;
        }
        
        .loan-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .loan-amount {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .loan-client {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-top: 0.3rem;
        }
        
        .loan-details {
            display: flex;
            gap: 1rem;
            margin-top: 0.5rem;
            font-size: 0.85rem;
        }
        
        .loan-term {
            color: var(--warning);
        }
        
        .loan-interest {
            color: var(--success);
        }
        
        .loan-payment {
            color: var(--primary);
        }

        /* Development Consultancy Specific Styles */
        .consultancy-card {
            border: 3px solid #4299e1;
            background: linear-gradient(135deg, #e6fffa, #f0fff4);
        }
        
        .consultancy-card .card-title {
            color: #4299e1;
        }
        
        .consultancy-badge {
            display: inline-block;
            background: #4299e1;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 5px;
        }
        
        .consultancy-contract {
            background: #f0f9ff;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            border: 2px solid #4299e1;
        }
        
        .consultancy-progress {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin: 0.5rem 0;
        }
        
        .consultancy-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4299e1, #38a169);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .consultancy-details-modal {
            max-width: 800px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="company-brand">
                <div class="company-logo" id="company-logo" onclick="openModal(&#39;companyModal&#39;)">
                    <i class="fas fa-building"></i>
                </div>
                <div class="company-name" id="company-name" onclick="openModal(&#39;companyModal&#39;)">
                    Financial Services Tycoon
                </div>
            </div>
            
            <div class="save-load-buttons">
                <button class="save-btn" onclick="saveGame()">
                    <i class="fas fa-save"></i> Save
                </button>
                <button class="load-btn" onclick="loadGame()">
                    <i class="fas fa-folder-open"></i> Load
                </button>
                <button class="reset-btn" onclick="resetGame()">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>
            
            <div class="real-time-display">
                <div class="time-display">
                    <span class="tt-flag">üáπüáπ</span>
                    <div>
                        <div id="real-time">10:47:14 pm</div>
                        <div id="real-date" style="font-size: 0.9rem; opacity: 0.9;">Tuesday, 30 December 2025</div>
                        <div id="auto-save-status" style="font-size: 0.8rem; margin-top: 3px; color: var(--success);">Auto-saved at 10:47 pm</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="tabs-container">
        <!-- Welcome Message -->
        <div class="welcome-message">
            <h2>Welcome, CEO!</h2>
            <p>Build your financial empire in real-time. Every decision counts!</p>
        </div>

        <!-- Main Balance -->
        <div class="main-balance">
            <div class="balance-label">Available Balance</div>
            <div class="balance-amount" id="main-balance">TTD $901.44</div>
            <div class="balance-label">Real-Time Trinidad &amp; Tobago</div>
        </div>

        <!-- Tabs Navigation -->
        <div class="tabs">
            <div class="tab" data-tab="dashboard">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </div>
            <div class="tab" data-tab="staff">
                <i class="fas fa-user-tie"></i> Staff
            </div>
            <div class="tab" data-tab="clients">
                <i class="fas fa-users"></i> Clients
            </div>
            <div class="tab active" data-tab="services">
                <i class="fas fa-cogs"></i> Services
            </div>
            <div class="tab" data-tab="reports">
            <i class="fas fa-chart-pie"></i> Accounting
            </div>
            
            
            <div class="tab" data-tab="customize">
                <i class="fas fa-paint-brush"></i> Customize
            </div>
        </div>
    </div>

    <!-- Tab Contents -->
    <main class="tabs-container">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content">
            <div class="cycle-display">
                <div class="cycle-info">
                    <div>Game Cycle Progress</div>
                    <div class="cycle-time" id="game-cycle">00:00</div>
                    <div>Next Revenue: <span id="next-revenue" class="positive">TTD $45.09</span></div>
                    <div style="font-size: 0.9rem; color: var(--text-light);">
                        <span id="last-cycle-status">Cycle completing soon</span>
                    </div>
                </div>
                <div class="progress-container" style="flex: 1; max-width: 400px;">
                    <div class="progress-label">
                        <span>Cycle Progress</span>
                        <span id="cycle-percent">100%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="cycle-progress" style="width: 100%;"></div>
                    </div>
                    <div style="font-size: 0.9rem; color: var(--text-light); margin-top: 0.5rem;">
                        Revenue collects every 2 minutes from active services
                        <div class="time-passed-display">
                            <i class="fas fa-clock"></i>
                            Time Passed: <span id="time-passed">0h 56m</span>
                            <i class="fas fa-calendar-day"></i>
                            Game Day: <span id="current-game-day">1</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Staff Requirements Warning -->
            <div id="staffing-status-display">
                    <div class="staffing-good">
                        <i class="fas fa-check-circle" style="color: var(--success); font-size: 1.5rem;"></i>
                        <div>
                            <strong>Staffing Status: Good</strong>
                            <div style="font-size: 0.9rem; color: var(--text-light);">
                                You have 1 staff for 1 required.
                            </div>
                        </div>
                    </div>
                </div>

            <div class="cards-grid">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üìà Daily Performance</h3>
                        <i class="fas fa-chart-bar card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Revenue Today</span>
                            <span class="stat-value positive" id="daily-revenue">TTD $721.44</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Expenses Today</span>
                            <span class="stat-value negative" id="daily-expenses">TTD $820.00</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Net Profit</span>
                            <span class="stat-value" id="net-profit">TTD $-98.56</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Profit Margin</span>
                            <span class="stat-value negative" id="profit-margin">-13.7%</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üè¢ Business Overview</h3>
                        <i class="fas fa-briefcase card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Active Clients</span>
                            <span class="stat-value" id="active-clients">1</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Active Services</span>
                            <span class="stat-value" id="active-services">1</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Total Staff</span>
                            <span class="stat-value" id="total-staff">1</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value positive" id="staff-required">1</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Company Value</span>
                            <span class="stat-value positive" id="company-value">TTD $13,800.00</span>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">‚ö° Quick Actions</h3>
                        <i class="fas fa-bolt card-icon"></i>
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                        <button class="btn btn-success" onclick="generateStatement()">
                            <i class="fas fa-file-invoice-dollar"></i> Generate Statement
                        </button>
                        <button class="btn btn-primary" onclick="openTab(&#39;services&#39;)">
                            <i class="fas fa-cogs"></i> Manage Services
                        </button>
                        <button class="btn btn-accent" onclick="openSalaryModal()">
                            <i class="fas fa-money-check-alt"></i> Set Salaries
                        </button>
                  			
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <h3 style="margin-bottom: 1.5rem; color: var(--primary);">üìä Revenue Trend</h3>
                <div class="chart-placeholder">
                    <i class="fas fa-chart-line" style="font-size: 3rem; opacity: 0.3; margin-right: 1rem;"></i>
                    <div>Revenue visualization will appear here</div>
                </div>
            </div>

            <!-- Actions Log -->
            <div class="actions-log-container">
                <h3 style="margin-bottom: 1.5rem; color: var(--primary);">üìù Actions Log</h3>
                <div class="actions-log" id="actions-log">
                    <div class="action-entry success">
                        <div class="action-time">10:47:14 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:46:49 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:46:49 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:45:14 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:42:55 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:40:54 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:40:54 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:38:53 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:38:53 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:38:53 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:38:53 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:36:57 pm</div>
                        <div class="action-message">üíæ Game saved manually!</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:36:53 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:36:53 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:34:14 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:31:52 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:30:07 pm</div>
                        <div class="action-message">üíæ Game saved manually!</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:30:06 pm</div>
                        <div class="action-message">üíæ Game saved manually!</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:30:04 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:30:04 pm</div>
                        <div class="action-message">üíæ Game saved manually!</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:29:52 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:29:52 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:25:14 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:22:22 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:22:22 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:22:22 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:20:22 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:18:22 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:18:22 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:05:14 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:05:14 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">10:04:48 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:02:48 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">10:00:48 pm</div>
                        <div class="action-message">üí∞ Revenue collected: TTD $45.09</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">9:59:39 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">9:59:39 pm</div>
                        <div class="action-message">‚úÖ Acquired üë®‚Äçüë©‚Äçüëß‚Äçüë¶ General Public client! Services activated.</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">9:59:26 pm</div>
                        <div class="action-message">üëî Hired Staff Member for TTD $320.00!</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">9:58:42 pm</div>
                        <div class="action-message">üí∞ CEO salary set to TTD $120,000 annually</div>
                    </div>
                
                    <div class="action-entry info">
                        <div class="action-time">9:56:47 pm</div>
                        <div class="action-message">üíæ Game auto-saved</div>
                    </div>
                
                    <div class="action-entry success">
                        <div class="action-time">9:56:47 pm</div>
                        <div class="action-message">üîÑ Game COMPLETELY reset! Starting fresh with TTD $1,000.</div>
                    </div>
                </div>
                <button class="btn btn-warning clear-log-btn" onclick="clearActionsLog()">
                    <i class="fas fa-trash"></i> Clear Log
                </button>
            </div>
        </div>



	<div id="reports" class="tab-content">
    <h2>Financial Reports</h2>
    <div id="report-content">
        <div class="sc-header" style="background: linear-gradient(135deg, #2c3e50 0%, #4a6491 100%); color: white; padding: 15px 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 6px;">
                        <i class="fas fa-file-invoice-dollar" style="font-size: 24px;"></i>
                    </div>
                    <div>
                        <h3 style="margin: 0; font-size: 20px; font-weight: 600;">Financial Report</h3>
                        <div style="display: flex; gap: 10px; margin-top: 5px; font-size: 14px;">
                            <span style="background: rgba(255,255,255,0.15); padding: 3px 8px; border-radius: 4px;">
                                <i class="fas fa-calendar-day"></i> Day 1
                            </span>
                            <span style="background: rgba(255,255,255,0.15); padding: 3px 8px; border-radius: 4px;">
                                <i class="fas fa-building"></i> Pelican Financial Group
                            </span>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="sc-button sc-button-secondary" onclick="changeReportDay(-1)" style="min-width: 100px;">
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <button class="sc-button sc-button-secondary" onclick="changeReportDay(1)" style="min-width: 100px;">
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    
            <div class="sc-card" style="background: white; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); overflow: hidden;">
                <div class="sc-card-header" style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="background: #3498db; color: white; width: 32px; height: 32px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-receipt"></i>
                        </div>
                        <h4 style="margin: 0; font-weight: 600; color: #2c3e50;">Transaction Ledger</h4>
                    </div>
                    <span style="font-size: 14px; color: #7f8c8d; margin-left: auto;">
                        8 transactions
                    </span>
                </div>
                <div style="max-height: 400px; overflow-y: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa; border-bottom: 2px solid #e9ecef;">
                                <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #2c3e50; font-size: 13px;">TIME</th>
                                <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #2c3e50; font-size: 13px;">TYPE</th>
                                <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #2c3e50; font-size: 13px;">DESCRIPTION</th>
                                <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #2c3e50; font-size: 13px;">AMOUNT</th>
                            </tr>
                        </thead>
                        <tbody>
        
                <tr style="border-bottom: 1px solid #f1f5f9; background: #fff;">
                    <td style="padding: 12px 15px; font-size: 13px; color: #7f8c8d;">09:59 pm</td>
                    <td style="padding: 12px 15px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #3498db;">
                                <i class="fas fa-exchange-alt"></i>
                            </span>
                            <span style="font-size: 13px; color: #2c3e50; text-transform: capitalize;">
                                staff hiring cost
                            </span>
                        </div>
                    </td>
                    <td style="padding: 12px 15px; font-size: 13px; color: #2c3e50; max-width: 300px;">
                        Hired üë®‚Äçüíº Staff Member
                    </td>
                    <td style="padding: 12px 15px; font-weight: 600; color: #e74c3c; font-size: 13px; text-align: right;">
                        -$320.00
                    </td>
                </tr>
            
                <tr style="border-bottom: 1px solid #f1f5f9; background: #f8f9fa;">
                    <td style="padding: 12px 15px; font-size: 13px; color: #7f8c8d;">09:59 pm</td>
                    <td style="padding: 12px 15px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #3498db;">
                                <i class="fas fa-handshake"></i>
                            </span>
                            <span style="font-size: 13px; color: #2c3e50; text-transform: capitalize;">
                                client acquisition
                            </span>
                        </div>
                    </td>
                    <td style="padding: 12px 15px; font-size: 13px; color: #2c3e50; max-width: 300px;">
                        Acquired üë®‚Äçüë©‚Äçüëß‚Äçüë¶ General Public client
                    </td>
                    <td style="padding: 12px 15px; font-weight: 600; color: #e74c3c; font-size: 13px; text-align: right;">
                        -$500.00
                    </td>
                </tr>
            
                <tr style="border-bottom: 1px solid #f1f5f9; background: #fff;">
                    <td style="padding: 12px 15px; font-size: 13px; color: #7f8c8d;">10:00 pm</td>
                    <td style="padding: 12px 15px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #3498db;">
                                <i class="fas fa-exchange-alt"></i>
                            </span>
                            <span style="font-size: 13px; color: #2c3e50; text-transform: capitalize;">
                                revenue collection
                            </span>
                        </div>
                    </td>
                    <td style="padding: 12px 15px; font-size: 13px; color: #2c3e50; max-width: 300px;">
                        Cycle revenue collection
                    </td>
                    <td style="padding: 12px 15px; font-weight: 600; color: #27ae60; font-size: 13px; text-align: right;">
                        +$45.09
                    </td>
                </tr>
            
                <tr style="border-bottom: 1px solid #f1f5f9; background: #f8f9fa;">
                    <td style="padding: 12px 15px; font-size: 13px; color: #7f8c8d;">10:02 pm</td>
                    <td style="padding: 12px 15px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #3498db;">
                                <i class="fas fa-exchange-alt"></i>
                            </span>
                            <span style="font-size: 13px; color: #2c3e50; text-transform: capitalize;">
                                revenue collection
                            </span>
                        </div>
                    </td>
                    <td style="padding: 12px 15px; font-size: 13px; color: #2c3e50; max-width: 300px;">
                        Cycle revenue collection
                    </td>
                    <td style="padding: 12px 15px; font-weight: 600; color: #27ae60; font-size: 13px; text-align: right;">
                        +$45.09
                    </td>
                </tr>
            
                <tr style="border-bottom: 1px solid #f1f5f9; background: #fff;">
                    <td style="padding: 12px 15px; font-size: 13px; color: #7f8c8d;">10:05 pm</td>
                    <td style="padding: 12px 15px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #3498db;">
                                <i class="fas fa-exchange-alt"></i>
                            </span>
                            <span style="font-size: 13px; color: #2c3e50; text-transform: capitalize;">
                                revenue collection
                            </span>
                        </div>
                    </td>
                    <td style="padding: 12px 15px; font-size: 13px; color: #2c3e50; max-width: 300px;">
                        Cycle revenue collection
                    </td>
                    <td style="padding: 12px 15px; font-weight: 600; color: #27ae60; font-size: 13px; text-align: right;">
                        +$45.09
                    </td>
                </tr>
            
                <tr style="border-bottom: 1px solid #f1f5f9; background: #f8f9fa;">
                    <td style="padding: 12px 15px; font-size: 13px; color: #7f8c8d;">10:18 pm</td>
                    <td style="padding: 12px 15px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #3498db;">
                                <i class="fas fa-exchange-alt"></i>
                            </span>
                            <span style="font-size: 13px; color: #2c3e50; text-transform: capitalize;">
                                revenue collection
                            </span>
                        </div>
                    </td>
                    <td style="padding: 12px 15px; font-size: 13px; color: #2c3e50; max-width: 300px;">
                        Cycle revenue collection
                    </td>
                    <td style="padding: 12px 15px; font-weight: 600; color: #27ae60; font-size: 13px; text-align: right;">
                        +$45.09
                    </td>
                </tr>
            
                <tr style="border-bottom: 1px solid #f1f5f9; background: #fff;">
                    <td style="padding: 12px 15px; font-size: 13px; color: #7f8c8d;">10:20 pm</td>
                    <td style="padding: 12px 15px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #3498db;">
                                <i class="fas fa-exchange-alt"></i>
                            </span>
                            <span style="font-size: 13px; color: #2c3e50; text-transform: capitalize;">
                                revenue collection
                            </span>
                        </div>
                    </td>
                    <td style="padding: 12px 15px; font-size: 13px; color: #2c3e50; max-width: 300px;">
                        Cycle revenue collection
                    </td>
                    <td style="padding: 12px 15px; font-weight: 600; color: #27ae60; font-size: 13px; text-align: right;">
                        +$45.09
                    </td>
                </tr>
            
                <tr style="border-bottom: 1px solid #f1f5f9; background: #f8f9fa;">
                    <td style="padding: 12px 15px; font-size: 13px; color: #7f8c8d;">10:22 pm</td>
                    <td style="padding: 12px 15px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #3498db;">
                                <i class="fas fa-exchange-alt"></i>
                            </span>
                            <span style="font-size: 13px; color: #2c3e50; text-transform: capitalize;">
                                revenue collection
                            </span>
                        </div>
                    </td>
                    <td style="padding: 12px 15px; font-size: 13px; color: #2c3e50; max-width: 300px;">
                        Cycle revenue collection
                    </td>
                    <td style="padding: 12px 15px; font-weight: 600; color: #27ae60; font-size: 13px; text-align: right;">
                        +$45.09
                    </td>
                </tr>
            
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                <div class="sc-card" style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                    <div class="sc-card-header" style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="background: #2ecc71; color: white; width: 32px; height: 32px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h4 style="margin: 0; font-weight: 600; color: #2c3e50;">Income Statement</h4>
                        </div>
                    </div>
                    <div style="padding: 20px;">
                        <div class="sc-stat-row" style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                            <span style="font-size: 14px; color: #7f8c8d;">Total Revenue</span>
                            <span style="font-weight: 600; color: #27ae60; font-size: 16px;">
                                $270.54
                            </span>
                        </div>
                        <div class="sc-stat-row" style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                            <span style="font-size: 14px; color: #7f8c8d;">Total Expenses</span>
                            <span style="font-weight: 600; color: #e74c3c; font-size: 16px;">
                                $820.00
                            </span>
                        </div>
                        <div class="sc-stat-row" style="display: flex; justify-content: space-between; padding: 15px 0; background: #f8f9fa; margin: 0 -20px; padding: 15px 20px; border-top: 2px solid #e9ecef; border-bottom: 2px solid #e9ecef;">
                            <span style="font-weight: 600; color: #2c3e50; font-size: 15px;">Net Income</span>
                            <span style="font-weight: 700; color: #e74c3c; font-size: 18px;">
                                $-549.46
                            </span>
                        </div>
                    </div>
                </div>
                
                <div class="sc-card" style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                    <div class="sc-card-header" style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="background: #e74c3c; color: white; width: 32px; height: 32px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <h4 style="margin: 0; font-weight: 600; color: #2c3e50;">Expense Breakdown</h4>
                        </div>
                    </div>
                    <div style="padding: 20px;">
        
                    <div class="sc-expense-item" style="display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f1f5f9;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="background: #1abc9c; color: white; width: 28px; height: 28px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-handshake" style="font-size: 12px;"></i>
                            </div>
                            <span style="font-size: 13px; color: #2c3e50;">Client Acquisition</span>
                        </div>
                        <span style="font-weight: 600; color: #e74c3c; font-size: 14px;">
                            $500.00
                        </span>
                    </div>
                
                    <div class="sc-expense-item" style="display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f1f5f9;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="background: #f39c12; color: white; width: 28px; height: 28px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-user-plus" style="font-size: 12px;"></i>
                            </div>
                            <span style="font-size: 13px; color: #2c3e50;">Staff Hiring Costs</span>
                        </div>
                        <span style="font-weight: 600; color: #e74c3c; font-size: 14px;">
                            $320.00
                        </span>
                    </div>
                
                    </div>
                </div>
            </div>
            
            <div class="sc-card" style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                <div class="sc-card-header" style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="background: #9b59b6; color: white; width: 32px; height: 32px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <h4 style="margin: 0; font-weight: 600; color: #2c3e50;">Financial Ratios</h4>
                    </div>
                </div>
                <div style="padding: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        
                <div class="sc-ratio-card" style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="color: #e74c3c; font-size: 24px; margin-bottom: 8px;">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <div style="font-size: 12px; color: #7f8c8d; margin-bottom: 5px;">
                        Profit Margin
                    </div>
                    <div style="font-weight: 700; color: #e74c3c; font-size: 18px;">
                        -203.1%
                    </div>
                </div>
            
                <div class="sc-ratio-card" style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="color: #3498db; font-size: 24px; margin-bottom: 8px;">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <div style="font-size: 12px; color: #7f8c8d; margin-bottom: 5px;">
                        Avg. Transaction
                    </div>
                    <div style="font-weight: 700; color: #3498db; font-size: 18px;">
                        $33.818
                    </div>
                </div>
            
                <div class="sc-ratio-card" style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="color: #e74c3c; font-size: 24px; margin-bottom: 8px;">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div style="font-size: 12px; color: #7f8c8d; margin-bottom: 5px;">
                        Expense Ratio
                    </div>
                    <div style="font-weight: 700; color: #e74c3c; font-size: 18px;">
                        303.1%
                    </div>
                </div>
            
                    </div>
                </div>
            </div>
        
        <style>
            .sc-button {
                padding: 10px 20px;
                border: none;
                border-radius: 6px;
                font-weight: 600;
                cursor: pointer;
                font-size: 14px;
                transition: all 0.2s;
            }
            
            .sc-button-secondary {
                background: white;
                color: #2c3e50;
                border: 1px solid #dfe6e9;
            }
            
            .sc-button-secondary:hover {
                background: #f8f9fa;
                border-color: #bdc3c7;
            }
            
            .sc-card {
                transition: transform 0.2s, box-shadow 0.2s;
            }
            
            .sc-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            }
            
            .sc-stat-row:hover {
                background: #f8f9fa;
            }
        </style>
    </div>
</div>


         <!-- Staff Tab -->
        <div id="staff" class="tab-content">
            <h2 style="margin-bottom: 1.5rem; color: var(--primary);">üëî Staff Management</h2>
              <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 1.5rem;">
                <button class="btn btn-accent" onclick="openSalaryModal()">
                    <i class="fas fa-money-check-alt"></i> Manage Salaries
                </button>
                <button class="btn btn-success" onclick="hireAdditionalStaffMember()">
                    <i class="fas fa-user-plus"></i> Hire Staff Member (TTD $320)
                </button>
                <button class="btn btn-primary" onclick="hireAdditionalStaffMember(&#39;temp&#39;)">
                    <i class="fas fa-user-clock"></i> Hire Temp Staff (TTD $200)
                </button>
            </div>
            <div class="cards-grid" id="staff-grid" style="margin-top: 1.5rem;"><div class="card ceo-card">
                    <div class="card-header">
                        <h3 class="card-title">üëë CEO/Founder</h3>
                        <i class="fas fa-crown card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Role</span>
                            <span class="stat-value">EXECUTIVE</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Annual Salary</span>
                            <span class="stat-value">TTD $120,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Daily Cost</span>
                            <span class="stat-value">TTD $328.767</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value positive">Hired</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-accent" onclick="updateCeoSalary()">
                                <i class="fas fa-edit"></i> Set My Salary
                            </button>
                    </div>
                </div><div class="card ">
                    <div class="card-header">
                        <h3 class="card-title">üí∞ CFO</h3>
                        <i class="fas fa-chart-pie card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Role</span>
                            <span class="stat-value">EXECUTIVE</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Hiring Cost</span>
                            <span class="stat-value">TTD $100,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Annual Salary</span>
                            <span class="stat-value">TTD $90,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">Available</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-success" onclick="toggleEmployee(&#39;cfo&#39;)" disabled="">
                                <i class="fas fa-user-plus"></i>
                                Hire (TTD $100,000)
                            </button>
                    </div>
                </div><div class="card ">
                    <div class="card-header">
                        <h3 class="card-title">üì¢ CMO</h3>
                        <i class="fas fa-bullhorn card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Role</span>
                            <span class="stat-value">EXECUTIVE</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Hiring Cost</span>
                            <span class="stat-value">TTD $100,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Annual Salary</span>
                            <span class="stat-value">TTD $80,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">Available</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-success" onclick="toggleEmployee(&#39;cmo&#39;)" disabled="">
                                <i class="fas fa-user-plus"></i>
                                Hire (TTD $100,000)
                            </button>
                    </div>
                </div><div class="card ">
                    <div class="card-header">
                        <h3 class="card-title">‚öôÔ∏è COO</h3>
                        <i class="fas fa-cogs card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Role</span>
                            <span class="stat-value">EXECUTIVE</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Hiring Cost</span>
                            <span class="stat-value">TTD $100,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Annual Salary</span>
                            <span class="stat-value">TTD $100,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">Available</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-success" onclick="toggleEmployee(&#39;coo&#39;)" disabled="">
                                <i class="fas fa-user-plus"></i>
                                Hire (TTD $100,000)
                            </button>
                    </div>
                </div><div class="card ">
                    <div class="card-header">
                        <h3 class="card-title">üíª CTO</h3>
                        <i class="fas fa-laptop-code card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Role</span>
                            <span class="stat-value">EXECUTIVE</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Hiring Cost</span>
                            <span class="stat-value">TTD $100,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Annual Salary</span>
                            <span class="stat-value">TTD $80,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">Available</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-success" onclick="toggleEmployee(&#39;cto&#39;)" disabled="">
                                <i class="fas fa-user-plus"></i>
                                Hire (TTD $100,000)
                            </button>
                    </div>
                </div><div class="card ">
                    <div class="card-header">
                        <h3 class="card-title">üëî Manager</h3>
                        <i class="fas fa-user-tie card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Role</span>
                            <span class="stat-value">MANAGEMENT</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Hiring Cost</span>
                            <span class="stat-value">TTD $70,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Annual Salary</span>
                            <span class="stat-value">TTD $50,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">Available</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-success" onclick="toggleEmployee(&#39;manager&#39;)" disabled="">
                                <i class="fas fa-user-plus"></i>
                                Hire (TTD $70,000)
                            </button>
                    </div>
                </div><div class="card staff-member-card">
                            <div class="card-header">
                                <h3 class="card-title">üë®‚Äçüíº Staff Member</h3>
                                <i class="fas fa-user-tie card-icon"></i>
                            </div><div class="boost-badge"><i class="fas fa-chart-line"></i> +0% Revenue</div>
                            <div class="stats">
                                <div class="stat-row">
                                    <span class="stat-label">Role</span>
                                    <span class="stat-value">OPERATIONS</span>
                                </div>
                                <div class="stat-row">
                                    <span class="stat-label">Annual Salary</span>
                                    <span class="stat-value">TTD $9,000.00</span>
                                </div>
                                <div class="stat-row">
                                    <span class="stat-label">Daily Cost</span>
                                    <span class="stat-value">TTD $24.658</span>
                                </div>
                                <div class="stat-row">
                                    <span class="stat-label">Revenue Boost</span>
                                    <span class="stat-value positive">+0%</span>
                                </div>
                                <div class="stat-row">
                                    <span class="stat-label">Status</span>
                                    <span class="stat-value positive">Hired</span>
                                </div>
                            </div>
                            <div style="margin-top: 1rem;">
                                <button class="btn btn-danger" onclick="removeStaffMember(0)">
                                    <i class="fas fa-user-slash"></i> Fire/Permanently Remove
                                </button>
                                <button class="btn btn-primary" onclick="adjustStaffSalary(0)">
                                    <i class="fas fa-edit"></i> Adjust Salary
                                </button></div></div></div>
        </div>

	



	<!-- Clients Tab -->
        <div id="clients" class="tab-content">
            <h2 style="margin-bottom: 1.5rem; color: var(--primary);">üë• Client Segments</h2>
            <div class="cards-grid" id="clients-grid"><div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ General Public <span class="staff-req-badge">1:10</span></h3>
                        <i class="fas fa-users card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Cost to Acquire</span>
                            <span class="stat-value">TTD $500</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Acquired Clients</span>
                            <span class="stat-value">1</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value neutral">1 staff</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Ratio</span>
                            <span class="stat-value">1 staff : 10 clients</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="acquireClient(&#39;generalPublic&#39;)" disabled="">
                            <i class="fas fa-user-plus"></i> Acquire Client (TTD $500)
                        </button>
                    </div>
                </div><div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ü™ô Financial Technology <span class="staff-req-badge">1:3</span></h3>
                        <i class="fas fa-microchip card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Cost to Acquire</span>
                            <span class="stat-value">TTD $1,200</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Acquired Clients</span>
                            <span class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value neutral">0 staff</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Ratio</span>
                            <span class="stat-value">1 staff : 3 clients</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="acquireClient(&#39;finTech&#39;)" disabled="">
                            <i class="fas fa-user-plus"></i> Acquire Client (TTD $1,200)
                        </button>
                    </div>
                </div><div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üí∞ High Net Worth <span class="staff-req-badge">1:3</span></h3>
                        <i class="fas fa-gem card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Cost to Acquire</span>
                            <span class="stat-value">TTD $100,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Acquired Clients</span>
                            <span class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value neutral">0 staff</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Ratio</span>
                            <span class="stat-value">1 staff : 3 clients</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="acquireClient(&#39;hnwi&#39;)" disabled="">
                            <i class="fas fa-user-plus"></i> Acquire Client (TTD $100,000)
                        </button>
                    </div>
                </div><div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üè¢ Corporate Clients <span class="staff-req-badge">1:2</span></h3>
                        <i class="fas fa-building card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Cost to Acquire</span>
                            <span class="stat-value">TTD $200,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Acquired Clients</span>
                            <span class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value neutral">0 staff</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Ratio</span>
                            <span class="stat-value">1 staff : 2 clients</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="acquireClient(&#39;corporate&#39;)" disabled="">
                            <i class="fas fa-user-plus"></i> Acquire Client (TTD $200,000)
                        </button>
                    </div>
                </div><div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üèõÔ∏è Government <span class="staff-req-badge">1:1</span></h3>
                        <i class="fas fa-landmark card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Cost to Acquire</span>
                            <span class="stat-value">TTD $10,000,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Acquired Clients</span>
                            <span class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value neutral">0 staff</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Ratio</span>
                            <span class="stat-value">1 staff : 1 clients</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="acquireClient(&#39;government&#39;)" disabled="">
                            <i class="fas fa-user-plus"></i> Acquire Client (TTD $10,000,000)
                        </button>
                    </div>
                </div><div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üõ°Ô∏è Insurance <span class="staff-req-badge">1:3</span></h3>
                        <i class="fas fa-shield-alt card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Cost to Acquire</span>
                            <span class="stat-value">TTD $15,000,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Acquired Clients</span>
                            <span class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value neutral">0 staff</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Ratio</span>
                            <span class="stat-value">1 staff : 3 clients</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="acquireClient(&#39;insuranceCompanies&#39;)" disabled="">
                            <i class="fas fa-user-plus"></i> Acquire Client (TTD $15,000,000)
                        </button>
                    </div>
                </div><div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üè¶ Banks <span class="staff-req-badge">1:2</span></h3>
                        <i class="fas fa-university card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Cost to Acquire</span>
                            <span class="stat-value">TTD $25,000,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Acquired Clients</span>
                            <span class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value neutral">0 staff</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Ratio</span>
                            <span class="stat-value">1 staff : 2 clients</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="acquireClient(&#39;banks&#39;)" disabled="">
                            <i class="fas fa-user-plus"></i> Acquire Client (TTD $25,000,000)
                        </button>
                    </div>
                </div><div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üí∞ Treasury <span class="staff-req-badge">1:2</span></h3>
                        <i class="fas fa-landmark card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Cost to Acquire</span>
                            <span class="stat-value">TTD $50,000,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Acquired Clients</span>
                            <span class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value neutral">0 staff</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Ratio</span>
                            <span class="stat-value">1 staff : 2 clients</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="acquireClient(&#39;treasury&#39;)" disabled="">
                            <i class="fas fa-user-plus"></i> Acquire Client (TTD $50,000,000)
                        </button>
                    </div>
                </div><div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üíº Major Companies <span class="staff-req-badge">1:1</span></h3>
                        <i class="fas fa-industry card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Cost to Acquire</span>
                            <span class="stat-value">TTD $100,000,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Acquired Clients</span>
                            <span class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value neutral">0 staff</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Ratio</span>
                            <span class="stat-value">1 staff : 1 clients</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="acquireClient(&#39;majorCompanies&#39;)" disabled="">
                            <i class="fas fa-user-plus"></i> Acquire Client (TTD $100,000,000)
                        </button>
                    </div>
                </div></div>
        </div>

        <!-- Services Tab -->
        <div id="services" class="tab-content active">
            <h2 style="margin-bottom: 1.5rem; color: var(--primary);">üíº Core Services</h2>
            <div class="cards-grid" id="services-grid"><div class="card ">
                    <div class="card-header">
                        <h3 class="card-title">ü§ù M&amp;A Services </h3>
                        <i class="fas fa-handshake card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Revenue/Cycle</span>
                            <span class="stat-value positive">TTD $3,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">
                                Inactive
                            </span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Cycle Time</span>
                            <span class="stat-value">2 minutes</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="toggleService(&#39;mergers&#39;)">
                            <i class="fas fa-power-off"></i> Activate
                        </button></div></div><div class="card ">
                    <div class="card-header">
                        <h3 class="card-title">üìä Consulting Services </h3>
                        <i class="fas fa-chart-line card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Revenue/Cycle</span>
                            <span class="stat-value positive">TTD $2,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">
                                Inactive
                            </span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Cycle Time</span>
                            <span class="stat-value">2 minutes</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="toggleService(&#39;consulting&#39;)">
                            <i class="fas fa-power-off"></i> Activate
                        </button></div></div><div class="card ">
                    <div class="card-header">
                        <h3 class="card-title">üßæ Accounting Services </h3>
                        <i class="fas fa-calculator card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Revenue/Cycle</span>
                            <span class="stat-value positive">TTD $500</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">
                                Inactive
                            </span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Cycle Time</span>
                            <span class="stat-value">2 minutes</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="toggleService(&#39;accounting&#39;)">
                            <i class="fas fa-power-off"></i> Activate
                        </button></div></div><div class="card ">
                    <div class="card-header">
                        <h3 class="card-title">üí∏ Remittance Services </h3>
                        <i class="fas fa-money-bill-wave card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Revenue/Cycle</span>
                            <span class="stat-value positive">TTD $45</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value positive">
                                Active
                            </span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Cycle Time</span>
                            <span class="stat-value">2 minutes</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-warning" onclick="toggleService(&#39;remittance&#39;)">
                            <i class="fas fa-power-off"></i> Deactivate
                        </button></div></div><div class="card ">
                    <div class="card-header">
                        <h3 class="card-title">üí∞ Investment Accounts </h3>
                        <i class="fas fa-coins card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Revenue/Cycle</span>
                            <span class="stat-value positive">TTD $200</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">
                                Inactive
                            </span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Cycle Time</span>
                            <span class="stat-value">2 minutes</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="toggleService(&#39;investment&#39;)">
                            <i class="fas fa-power-off"></i> Activate
                        </button></div></div><div class="card contract-card">
                    <div class="card-header">
                        <h3 class="card-title">üñ•Ô∏è Financial Systems &amp; Digital Transformation <span class="contract-badge">CONTRACT</span></h3>
                        <i class="fas fa-laptop-code card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Purchase Cost</span>
                            <span class="stat-value">TTD $150,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">Not Purchased</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="purchaseContractService(&#39;financialSystems&#39;)" disabled="">
                            <i class="fas fa-shopping-cart"></i> Purchase Service (TTD $150,000)
                        </button></div></div><div class="card contract-card">
                    <div class="card-header">
                        <h3 class="card-title">üìã Compliance Advisory <span class="contract-badge">CONTRACT</span></h3>
                        <i class="fas fa-clipboard-check card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Purchase Cost</span>
                            <span class="stat-value">TTD $150,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">Not Purchased</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="purchaseContractService(&#39;complianceAdvisory&#39;)" disabled="">
                            <i class="fas fa-shopping-cart"></i> Purchase Service (TTD $150,000)
                        </button></div></div><div class="card contract-card">
                    <div class="card-header">
                        <h3 class="card-title">üìä Tax Advisory <span class="contract-badge">CONTRACT</span></h3>
                        <i class="fas fa-file-invoice-dollar card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Purchase Cost</span>
                            <span class="stat-value">TTD $150,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">Not Purchased</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="purchaseContractService(&#39;taxAdvisory&#39;)" disabled="">
                            <i class="fas fa-shopping-cart"></i> Purchase Service (TTD $150,000)
                        </button></div></div><div class="card consultancy-card">
                <div class="card-header">
                    <h3 class="card-title">üíº Development Consultancy <span class="consultancy-badge">CONSULTANCY</span></h3>
                    <i class="fas fa-user-tie card-icon"></i>
                </div>
                <div class="stats">
                    <div class="stat-row">
                        <span class="stat-label">Status</span>
                        <span class="stat-value negative">
                            Inactive
                        </span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Active Contracts</span>
                        <span class="stat-value">0/2</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Manager</span>
                        <span class="stat-value negative">
                            Required
                        </span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Revenue</span>
                        <span class="stat-value positive">TTD $0.00</span>
                    </div>
                </div>
                <div style="margin-top: 1rem;">
                    <button class="btn btn-warning" onclick="toggleDevelopmentConsultancy()" disabled="">
                        <i class="fas fa-play"></i> Activate Development Consultancy
                    </button></div></div></div>
        </div>

       


          

        <!-- Customize Tab -->
        <div id="customize" class="tab-content">
            <div class="customization-section">
                <h2 style="margin-bottom: 1rem; color: var(--primary);">üé® Customize Your Company</h2>
                <p style="color: var(--text-light); margin-bottom: 2rem;">
                    Make your financial empire uniquely yours! Customize your company's appearance.
                </p>
                
                <div class="form-group">
                    <label class="form-label">Company Name</label>
                    <input type="text" class="form-input" id="company-name-input" value="Financial Services Tycoon" onchange="updateCompanyName(this.value)">
                </div>

                <div class="form-group">
                    <label class="form-label">Company Logo</label>
                    <div class="logo-upload">
                        <div class="logo-preview" id="logo-preview">
                            <i class="fas fa-building"></i>
                        </div>
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="uploadLogo()">
                                <i class="fas fa-upload"></i> Upload Logo
                            </button>
                            <button class="btn btn-warning" onclick="resetLogo()">
                                <i class="fas fa-redo"></i> Reset Logo
                            </button>
                            <button class="btn btn-accent" onclick="selectLogoEmoji()">
                                <i class="fas fa-smile"></i> Emoji Logo
                            </button>
                        </div>
                        <input type="file" id="logo-upload" accept="image/*" style="display: none;" onchange="handleLogoUpload(event)">
                        <div style="font-size: 0.9rem; color: var(--text-light); text-align: center;">
                            Upload a logo image or choose an emoji. Max size: 2MB
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">CEO Title</label>
                    <input type="text" class="form-input" id="ceo-title-input" value="Founder &amp; CEO" onchange="updateCeoTitle(this.value)">
                </div>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <div class="card-header">
                    <h3 class="card-title">üí° Customization Tips</h3>
                    <i class="fas fa-lightbulb card-icon"></i>
                </div>
                <div style="color: var(--text-light); line-height: 1.6;">
                    <p>‚Ä¢ Your company name appears in the header and all reports</p>
                    <p>‚Ä¢ The logo represents your brand identity</p>
                    <p>‚Ä¢ Custom CEO title adds personal touch to your profile</p>
                    <p>‚Ä¢ All customizations are saved automatically</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <div id="salaryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üí∞ Salary Management</h2>
                <button class="close-modal" onclick="closeModal(&#39;salaryModal&#39;)">√ó</button>
            </div>
            <div id="salary-controls">
                <!-- Salary controls will be loaded here -->
            </div>
        </div>
    </div>


    <div id="statementModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìä Financial Statement</h2>
                <button class="close-modal" onclick="closeModal(&#39;statementModal&#39;)">√ó</button>
            </div>
            <div id="statement-content">
                <!-- Statement will be loaded here -->
            </div>
        </div>
    </div>

    <div id="companyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üè¢ Company Profile</h2>
                <button class="close-modal" onclick="closeModal(&#39;companyModal&#39;)">√ó</button>
            </div>
            <div style="text-align: center; padding: 1rem;">
                <div class="logo-preview" style="width: 150px; height: 150px; margin: 0 auto 1.5rem;" id="modal-logo">
                    <i class="fas fa-building"></i>
                </div>
                <h3 id="modal-company-name" style="color: var(--primary); margin-bottom: 0.5rem;">Financial Services Tycoon</h3>
                <p id="modal-ceo-title" style="color: var(--text-light); font-style: italic;">Founder &amp; CEO</p>
                <div style="margin-top: 2rem;">
                    <button class="btn btn-primary" onclick="closeModal(&#39;companyModal&#39;); openTab(&#39;customize&#39;);">
                        <i class="fas fa-edit"></i> Edit Profile
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Contract Modals -->
    <div id="requirementsModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>üìã Service Requirements</h2>
                <button class="close-modal" onclick="closeModal(&#39;requirementsModal&#39;)">√ó</button>
            </div>
            <div id="requirements-content">
                <!-- Requirements will be loaded here -->
            </div>
        </div>
    </div>

    <div id="historyModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>üìú Contract History</h2>
                <button class="close-modal" onclick="closeModal(&#39;historyModal&#39;)">√ó</button>
            </div>
            <div id="history-content">
                <!-- History will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Loan Report Modal -->
    <div id="loanReportModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>üìã Loan Portfolio Report</h2>
                <button class="close-modal" onclick="closeModal(&#39;loanReportModal&#39;)">√ó</button>
            </div>
            <div id="loan-report-content">
                <!-- Loan report will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Development Consultancy Modal -->
    <div id="consultancyModal" class="modal">
        <div class="modal-content consultancy-details-modal">
            <div class="modal-header">
                <h2>üíº Development Consultancy Details</h2>
                <button class="close-modal" onclick="closeModal(&#39;consultancyModal&#39;)">√ó</button>
            </div>
            <div id="consultancy-details-content">
                <!-- Consultancy details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div class="notification-container" id="notification-container"></div>

    <script>
        // ============================================
        // GAME STATE INITIALIZATION
        // ============================================
        let gameState = JSON.parse(localStorage.getItem('financialTycoonGame')) || {
            // Core financials
            balance: 1000.00,
            dailyRevenue: 0,
            dailyExpenses: 0,
            gameDay: 1,
            
            // Timing
            lastUpdate: Date.now(),
            currentCycleStart: Date.now(),
            completedCyclesToday: 0,
            totalMinutesPassed: 0,
            
            // Auto-save tracking
            lastAutoSave: Date.now(),
            
            // Company info
            companyName: "Financial Services Tycoon",
            ceoTitle: "Founder & CEO",
            logoType: "icon",
            logoValue: "fas fa-building",
            
            // Game data
            clients: {},
            services: {},
            staff: {},
            investments: {},
            loans: [],
            staffMembers: [],
            
            // Development Consultancy
            developmentConsultancy: {
                active: false,
                managerAssigned: false,
                activeContracts: [],         // Max 2
                contractHistory: [],
                totalRevenue: 0,
                totalExpense: 0,
                totalPenalties: 0,
                lastContractCheck: Date.now()
            },

            // Contract Services
            contractServices: {},
            contractTimers: {},
            
            // Actions Log
            actionsLog: [],
            
            // Valuation data
            profitHistory: [],
            totalRevenueHistory: 0,
            totalExpenseHistory: 0
        };

        // Game Constants
        const CYCLE_SECONDS = 120; // 2 minutes in seconds for revenue collection
        const CYCLE_MS = CYCLE_SECONDS * 1000;
        const DAY_CYCLES = 720; // 720 cycles = 1 game day (24 real hours = 1440 minutes / 2)
        const AUTO_SAVE_INTERVAL = 4 * 60 * 1000; // 4 minutes = 240,000ms

        // ============================================
        // DEVELOPMENT CONSULTANCY CONFIGURATION
        // ============================================
        
        // Development Consultancy Configuration
        const developmentConsultancyConfig = {
            id: 'developmentConsultancy',
            name: 'üíº Development Consultancy',
            description: 'generalPublic,finTech',
            icon: 'fas fa-user-tie',
            
            // Tier pricing per CYCLE (2 minutes)
            tierPricing: {
                generalPublic: { revenue: 25.00, expense: 5.00, penalty: 1000.00 },
                finTech: { revenue: 100.00, expense: 20.00, penalty: 5000.00 },
                hnwi: { revenue: 300.00, expense: 60.00, penalty: 15000.00 },
                corporate: { revenue: 1000.00, expense: 200.00, penalty: 50000.00 },
                government: { revenue: 5000.00, expense: 1000.00, penalty: 250000.00 },
                insuranceCompanies: { revenue: 2000.00, expense: 400.00, penalty: 100000.00 },
                banks: { revenue: 3000.00, expense: 600.00, penalty: 150000.00 },
                treasury: { revenue: 7500.00, expense: 1500.00, penalty: 375000.00 },
                majorCompanies: { revenue: 10000.00, expense: 2000.00, penalty: 500000.00 }
            },
            
            // Service Rules
            maxClients: 2,               // Max 2 clients at once
            staffPerClient: 1,           // 1 staff member per client
            requiredManager: true,       // Needs a Manager
            contractDuration: 720,       // 720 cycles = 24 hours
            minManagerLevel: 1,          // Minimum manager level required
            contractCheckInterval: 60000 // Check for new contracts every minute
        };

        // ============================================
        // NEW CONTRACT SERVICES SYSTEM
        // ============================================
        
        // Game Constants for Contract Services
        const CONTRACT_CHECK_INTERVAL = 10 * 60 * 1000; // 10 minutes in milliseconds
        const CONTRACT_DURATION = 4 * 60 * 1000; // 4 minutes in milliseconds
        const CONTRACT_PURCHASE_COST = 150000; // $150,000 to purchase each service
        
        // New Contract Services Configuration
        const contractServicesConfig = [
            {
                id: 'financialSystems',
                name: 'üñ•Ô∏è Financial Systems & Digital Transformation',
                description: 'Digital transformation services for financial institutions',
                icon: 'fas fa-laptop-code',
                purchaseCost: CONTRACT_PURCHASE_COST,
                purchased: false,
                requirements: {
                    staff: ['cfo', 'cto'],
                    clients: ['banks', 'insuranceCompanies', 'government']
                },
                clientPricing: {
                    banks: { min: 120000, max: 250000 },
                    insuranceCompanies: { min: 120000, max: 200000 },
                    government: { min: 50000, max: 100000 }
                },
                currentContract: null,
                contractHistory: [],
                lastCheck: null,
                nextAvailable: null,
                activeUntil: null
            },
            {
                id: 'complianceAdvisory',
                name: 'üìã Compliance Advisory',
                description: 'Regulatory compliance services for financial institutions',
                icon: 'fas fa-clipboard-check',
                purchaseCost: CONTRACT_PURCHASE_COST,
                purchased: false,
                requirements: {
                    staff: ['cfo'],
                    clients: ['banks', 'insuranceCompanies', 'treasury']
                },
                clientPricing: {
                    banks: { min: 100000, max: 200000 },
                    insuranceCompanies: { min: 100000, max: 180000 },
                    treasury: { min: 100000, max: 220000 }
                },
                currentContract: null,
                contractHistory: [],
                lastCheck: null,
                nextAvailable: null,
                activeUntil: null
            },
            {
                id: 'taxAdvisory',
                name: 'üìä Tax Advisory',
                description: 'Tax planning and advisory services',
                icon: 'fas fa-file-invoice-dollar',
                purchaseCost: CONTRACT_PURCHASE_COST,
                purchased: false,
                requirements: {
                    staff: ['cfo'],
                    clients: ['majorCompanies', 'corporate', 'hnwi']
                },
                clientPricing: {
                    majorCompanies: { min: 85000, max: 180000 },
                    corporate: { min: 85000, max: 160000 },
                    hnwi: { min: 45000, max: 100000 }
                },
                currentContract: null,
                contractHistory: [],
                lastCheck: null,
                nextAvailable: null,
                activeUntil: null
            }
        ];

        // Staff Config
        const staffConfig = [
            {
                id: 'ceo',
                name: 'üëë CEO/Founder',
                role: 'executive',
                baseSalary: 0,
                hiringCost: 0,
                age: 35,
                icon: 'fas fa-crown'
            },
            {
                id: 'cfo',
                name: 'üí∞ CFO',
                role: 'executive',
                baseSalary: 90000,
                hiringCost: 100000,
                age: 45,
                icon: 'fas fa-chart-pie'
            },
            {
                id: 'cmo',
                name: 'üì¢ CMO',
                role: 'executive',
                baseSalary: 80000,
                hiringCost: 100000,
                age: 40,
                icon: 'fas fa-bullhorn'
            },
           

            {
                id: 'coo',
                name: '‚öôÔ∏è COO',
                role: 'executive',
                baseSalary: 100000,
                hiringCost: 100000,
                age: 42,
                icon: 'fas fa-cogs'
            },
            {
                id: 'cto',
                name: 'üíª CTO',
                role: 'executive',
                baseSalary: 80000,
                hiringCost: 100000,
                age: 38,
                icon: 'fas fa-laptop-code'
            },
            {    
             id: 'manager',
             name: 'üëî Manager',
             role: 'management',
             baseSalary: 50000,
             hiringCost: 70000,
             age: 35,
             icon: 'fas fa-user-tie'
            }

        ];

               // Function to create staff member objects
        function createStaffMember(type = 'regular') {
    const templates = {
        regular: {
            id: null,
            name: 'üë®‚Äçüíº Staff Member',
            role: 'operations',
            annualSalary: 9000,
            dailySalary: 9000 / 365,
            revenueContribution: 0.002,
            age: 28,
            icon: 'fas fa-user-tie',
            hiringCost: 320,  // CORRECT: Flat fee for regular staff
            hired: false,
            removed: false
        },
        temp: {
            id: null,
            name: 'üë©üèΩ‚Äçüíª Temp Staff',
            role: 'operations',
            annualSalary: 2000,
            dailySalary: 2000 / 365,
            revenueContribution: 0.001,
            age: 28,
            icon: 'fas fa-user-tie',
            hiringCost: 200,  // CORRECT: Flat fee for temp staff
            hired: false,
            removed: false
        }
    };
            
            return { ...templates[type] || templates.regular };
        }



        // ============================================
        // CLIENT SEGMENTS CONFIG WITH STAFF REQUIREMENTS
        // ============================================
        const clientSegmentsConfig = [
            {
                id: 'generalPublic',
                name: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶ General Public',
                cost: 500,
                services: ['remittance', 'developmentConsultancy'],
                revenueMultiplier: 1,
                description: 'Remittance & Savings services',
                icon: 'fas fa-users',
                staffRequirements: {
                    perClient: 0.1,    // 1 staff per 10 clients
                    minStaff: 1,
                    efficiency: 0.9
                }
            },
            {
                id: 'finTech',
                name: 'ü™ô Financial Technology',
                cost: 1200,
                services: ['remittance', 'investment', 'developmentConsultancy'],
                revenueMultiplier: 1.8,
                description: 'Fast-growing technology companies',
                icon: 'fas fa-microchip',
                staffRequirements: {
                    perClient: 0.33,   // 1 staff per 3 clients
                    minStaff: 2,
                    efficiency: 0.8
                }
            },
            {
                id: 'hnwi',
                name: 'üí∞ High Net Worth',
                cost: 100000,
                services: ['investment', 'consulting'],
                revenueMultiplier: 1.5,
                description: 'Investment & Advisory services',
                icon: 'fas fa-gem',
                staffRequirements: {
                    perClient: 0.33,   // 1 staff per 3 clients
                    minStaff: 1,
                    efficiency: 0.85
                }
            },
            {
                id: 'corporate',
                name: 'üè¢ Corporate Clients',
                cost: 200000,
                services: ['mergers', 'consulting', 'accounting'],
                revenueMultiplier: 2,
                description: 'M&A, Consulting, Accounting',
                icon: 'fas fa-building',
                staffRequirements: {
                    perClient: 0.5,    // 1 staff per 2 clients
                    minStaff: 2,
                    efficiency: 0.75
                }
            },
            {
                id: 'government',
                name: 'üèõÔ∏è Government',
                cost: 10000000,
                services: ['consulting'],
                revenueMultiplier: 3,
                description: 'Consulting & Advisory services',
                icon: 'fas fa-landmark',
                staffRequirements: {
                    perClient: 1,      // 1 staff per client
                    minStaff: 3,
                    efficiency: 0.7
                }
            },
            {
                id: 'insuranceCompanies',
                name: 'üõ°Ô∏è Insurance',
                cost: 15000000,
                services: [],
                revenueMultiplier: 2.2,
                description: 'Insurance and risk management',
                icon: 'fas fa-shield-alt',
                staffRequirements: {
                    perClient: 0.4,    // 1 staff per 2.5 clients
                    minStaff: 2,
                    efficiency: 0.8
                }
            },
            {
                id: 'banks',
                name: 'üè¶ Banks',
                cost: 25000000,
                services: ['mergers', 'consulting', 'accounting', 'investment'],
                revenueMultiplier: 2.5,
                description: 'Integrated banking services',
                icon: 'fas fa-university',
                staffRequirements: {
                    perClient: 0.5,    // 1 staff per 2 clients
                    minStaff: 3,
                    efficiency: 0.8
                }
            },
            {
                id: 'treasury',
                name: 'üí∞ Treasury',
                cost: 50000000,
                services: [],
                revenueMultiplier: 3.5,
                description: 'Government treasury and finance',
                icon: 'fas fa-landmark',
                staffRequirements: {
                    perClient: 0.66,   // 2 staff per 3 clients
                    minStaff: 3,
                    efficiency: 0.75
                }
            },
            {
                id: 'majorCompanies',
                name: 'üíº Major Companies',
                cost: 100000000,
                services: ['mergers', 'consulting', 'accounting'],
                revenueMultiplier: 4,
                description: 'Corporate services for large enterprises',
                icon: 'fas fa-industry',
                staffRequirements: {
                    perClient: 1,      // 1 staff per client
                    minStaff: 4,
                    efficiency: 0.7
                }
            },
           
          
        ];

        const servicesConfig = [
            {
                id: 'mergers',
                name: 'ü§ù M&A Services',
                revenue: 3000,
                description: 'Major Companies and Banks',
                icon: 'fas fa-handshake'
            },
            {
                id: 'consulting',
                name: 'üìä Consulting Services',
                revenue: 2000,
                description: 'Government Contracts',
                icon: 'fas fa-chart-line'
            },
            {
                id: 'accounting',
                name: 'üßæ Accounting Services',
                revenue: 500,
                description: 'Corporate Clients',
                icon: 'fas fa-calculator'
            },
            {
                id: 'remittance',
                name: 'üí∏ Remittance Services',
                revenue: 45,
                description: 'General Public, fintech',
                icon: 'fas fa-money-bill-wave'
            },
            {
                id: 'investment',
                name: 'üí∞ Investment Accounts',
                revenue: 200,
                description: 'High Net Worth Individuals',
                icon: 'fas fa-coins'
            }
            
        ];

        const investmentsConfig = [
            {
                id: 'govBonds',
                name: 'üèõÔ∏è Government Bonds',
                type: 'bond',
                rate: 3.5,
                term: 10,
                minAmount: 100000,
                icon: 'fas fa-landmark'
            },
            {
                id: 'corpBonds',
                name: 'üè¢ Corporate Bonds',
                type: 'bond',
                rate: 5.0,
                term: 5,
                minAmount: 50000,
                icon: 'fas fa-building'
            },
            {
                id: 'municipalBonds',
                name: 'üèôÔ∏è Municipal Bonds',
                type: 'bond',
                rate: 4.0,
                term: 7,
                minAmount: 75000,
                icon: 'fas fa-city'
            }
        ];

        // Initialize CEO if not exists
        if (!gameState.staff.ceo) {
            gameState.staff.ceo = {
                hired: true,
                currentSalary: 0
            };
        }

        // Initialize staffMembers array if not exists
        if (!gameState.staffMembers) {
            gameState.staffMembers = [];
        }

        // Initialize profit history if not exists
        if (!gameState.profitHistory) {
            gameState.profitHistory = [];
        }
        if (!gameState.totalRevenueHistory) {
            gameState.totalRevenueHistory = 0;
        }
        if (!gameState.totalExpenseHistory) {
            gameState.totalExpenseHistory = 0;
        }

        // Initialize actions log if not exists
        if (!gameState.actionsLog) {
            gameState.actionsLog = [];
        }

        // Initialize contract services if not exists
        function initContractServices() {
            if (!gameState.contractServices) {
                gameState.contractServices = {};
            }
            
            contractServicesConfig.forEach(service => {
                if (!gameState.contractServices[service.id]) {
                    gameState.contractServices[service.id] = {
                        purchased: false,
                        currentContract: null,
                        contractHistory: [],
                        lastCheck: null,
                        nextAvailable: null,
                        activeUntil: null
                    };
                }
            });
            
            // Initialize timer for contract checks
            if (!gameState.contractTimers) {
                gameState.contractTimers = {};
            }
            
            // Start timers for purchased services
            startContractCheckTimers();
        }

        // ============================================
        // DEVELOPMENT CONSULTANCY FUNCTIONS
        // ============================================

        // Initialize Development Consultancy
        function initDevelopmentConsultancy() {
            if (!gameState.developmentConsultancy) {
                gameState.developmentConsultancy = {
                    active: false,
                    managerAssigned: false,
                    activeContracts: [],
                    contractHistory: [],
                    totalRevenue: 0,
                    totalExpense: 0,
                    totalPenalties: 0,
                    lastContractCheck: Date.now()
                };
            }
            
            // Start consultancy check timer
            startConsultancyCheck();
        }

        // Start consultancy check interval
        function startConsultancyCheck() {
            // Check every minute for contract updates
            if (!window.consultancyTimer) {
                window.consultancyTimer = setInterval(checkConsultancyContracts, 60000);
            }
        }

        // Check and process consultancy contracts
        function checkConsultancyContracts() {
            if (!gameState.developmentConsultancy || !gameState.developmentConsultancy.active) return;
            
            const now = Date.now();
            const consultancy = gameState.developmentConsultancy;
            
            // Update last check time
            consultancy.lastContractCheck = now;
            
            // Check for completed contracts
            consultancy.activeContracts.forEach((contract, index) => {
                if (contract.endTime <= now) {
                    completeConsultancyContract(index);
                }
            });
            
            // Check if we can take more contracts
            if (consultancy.activeContracts.length < developmentConsultancyConfig.maxClients && consultancy.managerAssigned) {
                tryGenerateConsultancyContract();
            }
            
            // Re-render if needed
            renderDevelopmentConsultancyCard();
        }

        // Generate a consultancy contract
        function tryGenerateConsultancyContract() {
            if (!gameState.developmentConsultancy.active || 
                !gameState.developmentConsultancy.managerAssigned) return;
            
            // Check if we have available clients
            const availableClients = [];
            
            clientSegmentsConfig.forEach(client => {
                const clientState = gameState.clients[client.id];
                if (clientState && clientState.acquired > 0 && client.services.includes('developmentConsultancy')) {
                    availableClients.push(client.id);
                }
            });
            
            if (availableClients.length === 0) return;
            
            // 25% chance to generate a contract each minute
            if (Math.random() < 0.25) {
                generateConsultancyContract(availableClients);
            }
        }

        // Generate specific contract
        function generateConsultancyContract(availableClients) {
            const service = developmentConsultancyConfig;
            
            // Select random client
            const clientId = availableClients[Math.floor(Math.random() * availableClients.length)];
            const client = clientSegmentsConfig.find(c => c.id === clientId);
            const tier = service.tierPricing[clientId];
            
            if (!tier) return;
            
            const contract = {
                id: Date.now(),
                clientId: clientId,
                clientName: client.name,
                tier: tier,
                startTime: Date.now(),
                endTime: Date.now() + (24 * 60 * 60 * 1000), // 24 hours
                cyclesCompleted: 0,
                totalCycles: 720, // 24 hours at 2-minute cycles
                revenuePerCycle: tier.revenue,
                expensePerCycle: tier.expense,
                penalty: tier.penalty,
                status: 'active'
            };
            
            gameState.developmentConsultancy.activeContracts.push(contract);
            
            addActionToLog(`üìã Development Consultancy: New contract with ${client.name}`, "success");
            showNotification(`üìã New Development Consultancy contract! Client: ${client.name}`, "info");
            
            renderDevelopmentConsultancyCard();
            autoSave();
        }

        // Complete a consultancy contract
        function completeConsultancyContract(contractIndex) {
            const consultancy = gameState.developmentConsultancy;
            if (!consultancy || !consultancy.activeContracts[contractIndex]) return;
            
            const contract = consultancy.activeContracts[contractIndex];
            
            // Calculate final revenue (use actual cycles completed or minimum 1 cycle)
            const cycles = Math.max(1, contract.cyclesCompleted || 1);
            const totalRevenue = contract.revenuePerCycle * cycles;
            const totalExpense = contract.expensePerCycle * cycles;
            
            // Apply to game state
            gameState.balance += totalRevenue;
            gameState.dailyRevenue += totalRevenue;
            gameState.dailyExpenses += totalExpense;
            
            consultancy.totalRevenue += totalRevenue;
            consultancy.totalExpense += totalExpense;
            
            // Move to history
            consultancy.contractHistory.push({
                ...contract,
                status: 'completed',
                totalRevenue: totalRevenue,
                totalExpense: totalExpense,
                completionDate: Date.now()
            });
            
            // Remove from active
            consultancy.activeContracts.splice(contractIndex, 1);
            
            addActionToLog(`üí∞ Development Consultancy: Completed contract with ${contract.clientName}. Revenue: TTD $${totalRevenue.toLocaleString()}`, "success");
            showNotification(`üí∞ Development Consultancy contract completed! Revenue: TTD $${totalRevenue.toLocaleString()}`, "success");
            
            updateDashboard();
            renderDevelopmentConsultancyCard();
            autoSave();
        }

        // Toggle Development Consultancy
        function toggleDevelopmentConsultancy() {
            const service = developmentConsultancyConfig;
            
            // Check manager requirement
            if (!gameState.staff.manager || !gameState.staff.manager.hired) {
                showNotification("‚ùå Development Consultancy requires a Manager to be hired first!", "danger");
                return;
            }
            
            // Initialize if needed
            if (!gameState.developmentConsultancy) {
                initDevelopmentConsultancy();
            }
            
            const consultancy = gameState.developmentConsultancy;
            consultancy.active = !consultancy.active;
            
            if (consultancy.active) {
                // Check for manager
                if (gameState.staff.manager && gameState.staff.manager.hired) {
                    consultancy.managerAssigned = true;
                }
                
                // Start the service
                addActionToLog("üöÄ Development Consultancy service activated!", "success");
                showNotification("üöÄ Development Consultancy activated! Will generate contracts automatically.", "success");
                
                // Generate initial contract if possible
                setTimeout(() => tryGenerateConsultancyContract(), 1000);
            } else {
                // Cancel all active contracts with penalties
                consultancy.activeContracts.forEach(contract => {
                    consultancy.totalPenalties += contract.penalty;
                    gameState.balance -= contract.penalty;
                    gameState.dailyExpenses += contract.penalty;
                    
                    addActionToLog(`‚ö†Ô∏è Development Consultancy: Contract with ${contract.clientName} cancelled. Penalty: TTD $${contract.penalty.toLocaleString()}`, "warning");
                });
                
                consultancy.activeContracts = [];
                addActionToLog("‚è∏Ô∏è Development Consultancy service deactivated", "warning");
                showNotification("‚è∏Ô∏è Development Consultancy deactivated. Active contracts cancelled with penalties.", "warning");
            }
            
            // Update service state
            if (!gameState.services.developmentConsultancy) {
                gameState.services.developmentConsultancy = { active: consultancy.active };
            } else {
                gameState.services.developmentConsultancy.active = consultancy.active;
            }
            
            updateDashboard();
            renderDevelopmentConsultancyCard();
            renderServices();
            autoSave();
        }

        // Calculate Development Consultancy revenue per cycle
        function calculateDevelopmentConsultancyRevenue() {
    if (!gameState.developmentConsultancy || !gameState.developmentConsultancy.active) return 0;
    
    let totalRevenue = 0;
    let totalExpense = 0;
    
    // Check if activeContracts exists
    if (!gameState.developmentConsultancy.activeContracts) {
        gameState.developmentConsultancy.activeContracts = [];
    }
    
    gameState.developmentConsultancy.activeContracts.forEach(contract => {
        if (contract && contract.revenuePerCycle) {
            totalRevenue += contract.revenuePerCycle;
            totalExpense += contract.expensePerCycle || 0;
            
            // Track cycles
            contract.cyclesCompleted = (contract.cyclesCompleted || 0) + 1;
        }
    });
    
    // Update expenses
    if (totalExpense > 0) {
        gameState.dailyExpenses += totalExpense;
    }
    
    return totalRevenue;
}

        // Render Development Consultancy card
        function renderDevelopmentConsultancyCard() {
            const servicesGrid = document.getElementById('services-grid');
            if (!servicesGrid) return;
            
            // Remove existing consultancy card if present
            const existingCards = servicesGrid.querySelectorAll('.card.consultancy-card');
            existingCards.forEach(card => card.remove());
            
            const service = developmentConsultancyConfig;
            const consultancy = gameState.developmentConsultancy || {
                active: false,
                managerAssigned: false,
                activeContracts: [],
                contractHistory: [],
                totalRevenue: 0,
                totalExpense: 0,
                totalPenalties: 0
            };
    


            const serviceState = gameState.services.developmentConsultancy || { active: false };
            
            // Create card
            const card = document.createElement('div');
            card.className = 'card consultancy-card';
            
            let cardHTML = `
                <div class="card-header">
                    <h3 class="card-title">${service.name} <span class="consultancy-badge">CONSULTANCY</span></h3>
                    <i class="${service.icon} card-icon"></i>
                </div>
                <div class="stats">
                    <div class="stat-row">
                        <span class="stat-label">Status</span>
                        <span class="stat-value ${consultancy.active ? 'positive' : 'negative'}">
                            ${consultancy.active ? 'Active' : 'Inactive'}
                        </span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Active Contracts</span>
                        <span class="stat-value">${consultancy.activeContracts.length}/${service.maxClients}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Manager</span>
                        <span class="stat-value ${consultancy.managerAssigned ? 'positive' : 'negative'}">
                            ${consultancy.managerAssigned ? 'Assigned' : 'Required'}
                        </span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Revenue</span>
                        <span class="stat-value positive">TTD $${consultancy.totalRevenue.toLocaleString('en-US', {minimumFractionDigits: 2})}</span>
                    </div>`;
            
            // Show active contracts if any
            if (consultancy.activeContracts.length > 0) {
                consultancy.activeContracts.forEach(contract => {
                    const timeRemaining = contract.endTime - Date.now();
                    const hoursRemaining = Math.max(0, Math.floor(timeRemaining / (60 * 60 * 1000)));
                    const minutesRemaining = Math.max(0, Math.floor((timeRemaining % (60 * 60 * 1000)) / (60 * 1000)));
                    const progress = contract.cyclesCompleted ? ((contract.cyclesCompleted || 0) / contract.totalCycles * 100).toFixed(1) : '0.0';
                    
                    cardHTML += `
                        <div class="consultancy-contract">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <strong>${contract.clientName}</strong>
                                <span class="positive">TTD $${contract.revenuePerCycle.toLocaleString()}/cycle</span>
                            </div>
                            <div class="consultancy-progress">
                                <div class="consultancy-progress-fill" style="width: ${progress}%"></div>
                            </div>
                            <div style="font-size: 0.9rem; color: var(--text-light);">
                                <div>Time remaining: ${hoursRemaining}h ${minutesRemaining}m</div>
                                <div>Progress: ${progress}%</div>
                                <div>Expense: TTD $${contract.expensePerCycle.toLocaleString()}/cycle</div>
                            </div>
                        </div>`;
                });
            }
            
            cardHTML += `
                </div>
                <div style="margin-top: 1rem;">`;
            
            // Action buttons
            if (!consultancy.active) {
                cardHTML += `
                    <button class="btn ${gameState.staff.manager && gameState.staff.manager.hired ? 'btn-success' : 'btn-warning'}" 
                            onclick="toggleDevelopmentConsultancy()"
                            ${!gameState.staff.manager || !gameState.staff.manager.hired ? 'disabled' : ''}>
                        <i class="fas fa-play"></i> Activate Development Consultancy
                    </button>`;
            } else {
                cardHTML += `
                    <button class="btn btn-warning" onclick="toggleDevelopmentConsultancy()">
                        <i class="fas fa-stop"></i> Deactivate
                    </button>
                    <button class="btn btn-primary" onclick="viewConsultancyDetails()" style="margin-left: 0.5rem;">
                        <i class="fas fa-chart-bar"></i> Details
                    </button>`;
            }
            
            cardHTML += `</div>`;
            card.innerHTML = cardHTML;
            
            // Add to services grid
            servicesGrid.appendChild(card);
        }

        // View consultancy details
        function viewConsultancyDetails() {
            const consultancy = gameState.developmentConsultancy || {
                active: false,
                managerAssigned: false,
                activeContracts: [],
                contractHistory: [],
                totalRevenue: 0,
                totalExpense: 0,
                totalPenalties: 0
            };
            
            let html = `
                <h3 style="color: var(--primary); margin-bottom: 1.5rem;">üíº Development Consultancy Details</h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    <div style="background: #f0f9ff; padding: 1rem; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2rem; color: var(--primary); font-weight: bold;">TTD $${consultancy.totalRevenue.toLocaleString('en-US', {minimumFractionDigits: 2})}</div>
                        <div style="color: var(--text-light);">Total Revenue</div>
                    </div>
                    <div style="background: #f0fff4; padding: 1rem; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2rem; color: var(--success); font-weight: bold;">${consultancy.contractHistory.length}</div>
                        <div style="color: var(--text-light);">Completed Contracts</div>
                    </div>
                    <div style="background: #fefce8; padding: 1rem; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2rem; color: var(--warning); font-weight: bold;">${consultancy.activeContracts.length}</div>
                        <div style="color: var(--text-light);">Active Contracts</div>
                    </div>
                    <div style="background: #fff5f5; padding: 1rem; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2rem; color: var(--danger); font-weight: bold;">TTD $${consultancy.totalPenalties.toLocaleString('en-US', {minimumFractionDigits: 2})}</div>
                        <div style="color: var(--text-light);">Total Penalties</div>
                    </div>
                </div>
                
                <h4 style="color: var(--primary); margin-bottom: 1rem;">Active Contracts</h4>`;
    
            if (consultancy.activeContracts.length === 0) {
                html += `<p style="color: var(--text-light); text-align: center; padding: 2rem;">No active contracts</p>`;
            } else {
                html += `<div style="max-height: 300px; overflow-y: auto;">`;
                consultancy.activeContracts.forEach(contract => {
                    const timeRemaining = contract.endTime - Date.now();
                    const hours = Math.floor(timeRemaining / (60 * 60 * 1000));
                    const minutes = Math.floor((timeRemaining % (60 * 60 * 1000)) / (60 * 1000));
                    const progress = contract.cyclesCompleted ? ((contract.cyclesCompleted || 0) / contract.totalCycles * 100).toFixed(1) : '0.0';
                    
                    html += `
                        <div style="background: #f8fafc; padding: 1rem; border-radius: 8px; margin-bottom: 0.8rem; border-left: 4px solid var(--success);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <strong>${contract.clientName}</strong>
                                <span class="positive">TTD $${contract.revenuePerCycle.toLocaleString()}/cycle</span>
                            </div>
                            <div style="font-size: 0.9rem; color: var(--text-light); margin-top: 0.5rem;">
                                <div>Time remaining: ${hours}h ${minutes}m</div>
                                <div>Progress: ${progress}%</div>
                                <div>Expense: TTD $${contract.expensePerCycle.toLocaleString()}/cycle</div>
                                <div>Penalty for cancellation: TTD $${contract.penalty.toLocaleString()}</div>
                            </div>
                        </div>`;
                });
                html += `</div>`;
            }
            
            // Show contract history
            html += `
                <h4 style="color: var(--primary); margin-bottom: 1rem; margin-top: 2rem;">Contract History</h4>`;
            
            if (consultancy.contractHistory.length === 0) {
                html += `<p style="color: var(--text-light); text-align: center; padding: 1rem;">No contract history</p>`;
            } else {
                html += `<div style="max-height: 300px; overflow-y: auto;">`;
                // Show last 10 contracts
                const recentContracts = consultancy.contractHistory.slice(-10).reverse();
                recentContracts.forEach(contract => {
                    const date = new Date(contract.completionDate || contract.startTime).toLocaleDateString();
                    
                    html += `
                        <div style="background: #f8fafc; padding: 0.8rem; border-radius: 8px; margin-bottom: 0.5rem; border-left: 4px solid var(--primary);">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <strong>${contract.clientName}</strong>
                                <span class="positive">TTD $${(contract.totalRevenue || contract.revenuePerCycle).toLocaleString()}</span>
                            </div>
                            <div style="font-size: 0.8rem; color: var(--text-light);">
                                <div>Completed: ${date}</div>
                                <div>Status: ${contract.status === 'completed' ? 'Completed' : 'Cancelled'}</div>
                            </div>
                        </div>`;
                });
                html += `</div>`;
            }
            
            html += `
                <div style="margin-top: 2rem; text-align: center;">
                    <button class="btn btn-primary" onclick="closeModal('consultancyModal')">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            </div>`;
            
            document.getElementById('consultancy-details-content').innerHTML = html;
            openModal('consultancyModal');
        }

        // ============================================
        // NEW STAFF REQUIREMENTS SYSTEM
        // ============================================

        // Calculate total staff required for all clients
        function calculateTotalStaffRequired() {
            let totalRequired = 0;
            
            clientSegmentsConfig.forEach(client => {
                const clientState = gameState.clients[client.id];
                if (clientState && clientState.acquired > 0) {
                    const requirements = client.staffRequirements;
                    if (requirements) {
                        const segmentRequired = Math.max(
                            requirements.minStaff || 1,
                            Math.ceil(clientState.acquired * requirements.perClient)
                        );
                        totalRequired += segmentRequired;
                    }
                }
            });
            
            return totalRequired;
        }

        // Calculate available staff (including staff members)
        function calculateAvailableStaff() {
            let totalStaff = 0; // CEO DOES NOT COUNT as operational staff!
            
             // Count executive staff (only if they're operations/management)
            staffConfig.forEach(employee => {
                const employeeState = gameState.staff[employee.id];
                if (employeeState && employeeState.hired && employee.id !== 'ceo') {
                   

		// Only count non-CEO executives if they have operational roles
            if (employee.role === 'operations' || employee.role === 'management') {
                  totalStaff++;
            }
            // CFO, CMO, COO, CTO are executives, not operational staff
        }
    });
            // Count staff members (these ARE operational)
            if (gameState.staffMembers) {
                totalStaff += gameState.staffMembers.filter(staff => staff.hired).length;
            }
            
            return totalStaff;
        }

                        // Check staffing status and apply penalties
        function checkAndApplyStaffingPenalty() {
            const requiredStaff = calculateTotalStaffRequired();
            const availableStaff = calculateAvailableStaff();
            
            if (requiredStaff === 0) return {
                penalty: 0,
                message: "No clients yet - no staff required",
                status: "good"
            };
            
            if (availableStaff >= requiredStaff) {
                return {
                    penalty: 0,
                    message: "‚úì Adequately staffed",
                    status: "good"
                };
            } else {
                const shortage = requiredStaff - availableStaff;
                const penaltyPercent = Math.min(50, (shortage / requiredStaff) * 100);
                return {
                    penalty: penaltyPercent / 100,
                    message: `‚ö†Ô∏è Understaffed by ${shortage} staff (${penaltyPercent.toFixed(0)}% revenue penalty)`,
                    status: "warning"
                };
            }
        }

        // Update the staffing status display
        function updateStaffingStatusDisplay() {
            const displayElement = document.getElementById('staffing-status-display');
            if (!displayElement) return;
            
            const staffingStatus = checkAndApplyStaffingPenalty();
            const requiredStaff = calculateTotalStaffRequired();
            const availableStaff = calculateAvailableStaff();
            
            if (requiredStaff === 0) {
                displayElement.innerHTML = '';
                return;
            }
            
            if (staffingStatus.penalty === 0) {
                displayElement.innerHTML = `
                    <div class="staffing-good">
                        <i class="fas fa-check-circle" style="color: var(--success); font-size: 1.5rem;"></i>
                        <div>
                            <strong>Staffing Status: Good</strong>
                            <div style="font-size: 0.9rem; color: var(--text-light);">
                                You have ${availableStaff} staff for ${requiredStaff} required.
                            </div>
                        </div>
                    </div>
                `;
            } else {
                displayElement.innerHTML = `
                    <div class="staffing-warning">
                        <i class="fas fa-exclamation-triangle" style="color: var(--warning); font-size: 1.5rem;"></i>
                        <div>
                            <strong>Staffing Warning!</strong>
                            <div style="font-size: 0.9rem; color: var(--text-light);">
                                ${staffingStatus.message} - Hire more staff in the Staff tab.
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // ============================================
        // CORE GAME FUNCTIONS (MODIFIED)
        // ============================================
        
        // Add action to log
        function addActionToLog(message, type = 'info') {
            if (!gameState.actionsLog) {
                gameState.actionsLog = [];
            }
            
            const action = {
                timestamp: new Date().toLocaleTimeString(),
                message: message,
                type: type
            };
            
            gameState.actionsLog.unshift(action);
            
            if (gameState.actionsLog.length > 100) {
                gameState.actionsLog.pop();
            }
            
            renderActionsLog();
            autoSave();
        }

        // Render actions log
        function renderActionsLog() {
            const actionsLog = document.getElementById('actions-log');
            if (!actionsLog) return;
            
            if (!gameState.actionsLog || gameState.actionsLog.length === 0) {
                actionsLog.innerHTML = `
                    <div style="text-align: center; padding: 2rem; color: var(--text-light);">
                        <i class="fas fa-clipboard-list" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>No actions recorded yet.</p>
                        <p style="font-size: 0.9rem;">Game actions will appear here.</p>
                    </div>
                `;
                return;
            }
            
            let html = '';
            gameState.actionsLog.forEach(action => {
                html += `
                    <div class="action-entry ${action.type}">
                        <div class="action-time">${action.timestamp}</div>
                        <div class="action-message">${action.message}</div>
                    </div>
                `;
            });
            
            actionsLog.innerHTML = html;
        }

        // Clear actions log
        function clearActionsLog() {
            if (confirm("Clear all actions from the log?")) {
                gameState.actionsLog = [];
                renderActionsLog();
                addActionToLog("‚úÖ Actions log cleared", "info");
            }
        }

        // Initialize Game - FIXED VERSION
function initGame() {
    console.log("üéÆ Initializing game...");
    
    // Load saved game state first
    const savedGame = localStorage.getItem('financialTycoonGame');
    if (savedGame) {
        gameState = JSON.parse(savedGame);
    }
    
    // Ensure gameState has all required properties (but don't overwrite customizations)
    if (!gameState.financialLedger) {
        gameState.financialLedger = [];
    }
    if (!gameState.dailyTransactionLog) {
        gameState.dailyTransactionLog = {};
    }
    
    // DON'T reset company name/logo here - they should already be loaded from saved game
    // If they're missing, only then set defaults
    if (!gameState.companyName) {
        gameState.companyName = "Financial Services Tycoon";
    }
    if (!gameState.ceoTitle) {
        gameState.ceoTitle = "Founder & CEO";
    }
    if (!gameState.logoType) {
        gameState.logoType = "icon";
    }
    if (!gameState.logoValue) {
        gameState.logoValue = "fas fa-building";
    }
    
    updateRealTime();
    setInterval(updateRealTime, 1000);
    
    processTimePassed();
    startGameLoop();
    
    // Initialize auto-save system
    initAutoSave();
    
    // Initialize contract services
    if (typeof initContractServices === 'function') {
        initContractServices();
    }
    
    // Initialize Development Consultancy
    if (typeof initDevelopmentConsultancy === 'function') {
        initDevelopmentConsultancy();
    }
    
    // Initialize financial ledger
    if (typeof initFinancialLedger === 'function') {
        initFinancialLedger();
    }
    
    // Setup reports tab
    if (typeof setupReportsTab === 'function') {
        setupReportsTab();
    }
    
    // Update company display BEFORE rendering everything
    updateCompanyDisplay();
    
    renderAllContent();
    renderActionsLog();
    
    // Update loan statistics
    if (typeof updateLoanStatistics === 'function') {
        updateLoanStatistics();
    }
    
    console.log("‚úÖ Game initialized successfully!");
    showNotification("üéÆ Game loaded! Revenue collects every 2 minutes.", "success");
    addActionToLog("üéÆ Game loaded successfully", "info");
}


			



        // Start the game loop
        function startGameLoop() {
            setInterval(updateCycleTimer, 1000);
            
            setInterval(() => {
                gameState.totalMinutesPassed = (gameState.totalMinutesPassed || 0) + 1/60;
                updateTimePassedDisplay();
            }, 1000);
            
            console.log("üîÑ Game loop started");
        }

        // Process time passed
        function processTimePassed() {
            const now = Date.now();
            const lastUpdate = gameState.lastUpdate || now;
            const timePassedMs = now - lastUpdate;
            const minutesPassed = timePassedMs / 60000;
            
            gameState.totalMinutesPassed = (gameState.totalMinutesPassed || 0) + minutesPassed;
            
            const cyclesMissed = Math.floor(minutesPassed / 2);
            
            if (cyclesMissed > 0) {
                let totalMissedRevenue = 0;
                for (let i = 0; i < cyclesMissed; i++) {
                    totalMissedRevenue += calculateCycleRevenue();
                    
                    gameState.completedCyclesToday++;
                    
                    if (gameState.completedCyclesToday >= DAY_CYCLES) {
                        resetDaily();
                        gameState.completedCyclesToday = 0;
                    }
                }
                
                if (totalMissedRevenue > 0) {
                    gameState.balance += totalMissedRevenue;
                    gameState.dailyRevenue += totalMissedRevenue;
                    
                    addActionToLog(`üí∞ Offline revenue: TTD $${totalMissedRevenue.toLocaleString('en-US', {minimumFractionDigits: 2})} (${cyclesMissed} cycles)`, "success");
                }
            }
            
            gameState.lastUpdate = now;
            
            const timeSinceCycleStart = (now - (gameState.currentCycleStart || now)) % CYCLE_MS;
            gameState.currentCycleStart = now - timeSinceCycleStart;
            
            updateTimePassedDisplay();
            updateDashboard();
        }

        // Update time passed display
        function updateTimePassedDisplay() {
            const totalMinutes = Math.floor(gameState.totalMinutesPassed || 0);
            const hours = Math.floor(totalMinutes / 60);
            const minutes = totalMinutes % 60;
            
            const timePassedElement = document.getElementById('time-passed');
            const gameDayElement = document.getElementById('current-game-day');
            
            if (timePassedElement) {
                timePassedElement.textContent = `${hours}h ${minutes}m`;
            }
            if (gameDayElement) {
                gameDayElement.textContent = gameState.gameDay;
            }
        }

                        // Calculate cycle revenue (MODIFIED WITH STAFFING PENALTY AND DEVELOPMENT CONSULTANCY)
        function calculateCycleRevenue() {
            let revenue = 0;
            
            // 1. Calculate service revenue PER CYCLE (2 minutes)
            servicesConfig.forEach(service => {
                const serviceState = gameState.services[service.id];
                
                if (service.id === 'smeFinancing') return;
                
                if (serviceState && serviceState.active === true) {
                    let serviceClients = 0;
                    
                    clientSegmentsConfig.forEach(client => {
                        const clientState = gameState.clients[client.id];
                        
                        if (clientState && clientState.acquired > 0) {
                            if (client.services.includes(service.id)) {
                                serviceClients += clientState.acquired;
                            }
                        }
                    });
                    
                    revenue += service.revenue * serviceClients;
                }
            });
            
            // 2. Calculate Development Consultancy revenue
            if (gameState.developmentConsultancy && gameState.developmentConsultancy.active) {
                revenue += calculateDevelopmentConsultancyRevenue();
            }
            
            // 3. Calculate loan interest revenue PER CYCLE
            if (gameState.loans && gameState.loans.length > 0) {
                gameState.loans.forEach(loan => {
                    if (!loan.paidOff && loan.remainingTerm > 0) {
                        const cyclesPerYear = DAY_CYCLES * 365;
                        const interestPerCycle = (loan.amount * (loan.interestRate / 100)) / cyclesPerYear;
                        revenue += interestPerCycle;
                    }
                });
            }
            
            // 4. Apply staff member revenue boost
            if (gameState.staffMembers && gameState.staffMembers.length > 0) {
                const activeStaffMembers = gameState.staffMembers.filter(staff => staff.hired);
                if (activeStaffMembers.length > 0) {
                    let totalBoost = 1;
                    activeStaffMembers.forEach(staff => {
                        totalBoost += staff.revenueContribution || 0.005;
                    });
                    revenue *= totalBoost;
                }
            }
            
            // 5. Apply staffing penalty
            const staffingStatus = checkAndApplyStaffingPenalty();
            revenue *= (1 - staffingStatus.penalty);
            
            return revenue;
        }

        // Update cycle timer
        function updateCycleTimer() {
            const now = Date.now();
            const cycleStart = gameState.currentCycleStart || now;
            const timePassed = now - cycleStart;
            const timeRemaining = Math.max(0, CYCLE_MS - timePassed);
            
            const progress = Math.min((timePassed / CYCLE_MS) * 100, 100);
            
            const progressFill = document.getElementById('cycle-progress');
            const cyclePercent = document.getElementById('cycle-percent');
            if (progressFill) progressFill.style.width = `${progress}%`;
            if (cyclePercent) cyclePercent.textContent = `${Math.round(progress)}%`;
            
            const minutes = Math.floor(timeRemaining / 60000);
            const seconds = Math.floor((timeRemaining % 60000) / 1000);
            const gameCycleElement = document.getElementById('game-cycle');
            if (gameCycleElement) {
                gameCycleElement.textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            const nextRevenue = calculateCycleRevenue();
            const nextRevenueElement = document.getElementById('next-revenue');
            if (nextRevenueElement) {
                nextRevenueElement.textContent = 
                    `TTD $${nextRevenue.toLocaleString('en-US', {minimumFractionDigits: 2})}`;
            }
            
            updateCycleStatus();
            
            if (timePassed >= CYCLE_MS) {
                completeCycle();
            }
        }

        // Update cycle status display
        function updateCycleStatus() {
            const now = Date.now();
            const cycleStart = gameState.currentCycleStart || now;
            const timePassed = now - cycleStart;
            const minutesPassed = Math.floor(timePassed / 60000);
            const secondsPassed = Math.floor((timePassed % 60000) / 1000);
            
            let statusText = "";
            
            if (minutesPassed === 0 && secondsPassed < 30) {
                statusText = "Cycle just started";
            } else if (minutesPassed === 0) {
                statusText = `${60 - secondsPassed} seconds until next cycle`;
            } else if (minutesPassed === 1) {
                statusText = `${120 - secondsPassed - 60} seconds until next cycle`;
            } else {
                statusText = "Cycle completing soon";
            }
            
            const statusElement = document.getElementById('last-cycle-status');
            if (statusElement) {
                statusElement.textContent = statusText;
            }
        }

        function completeCycle() {
    const cycleRevenue = calculateCycleRevenue();
    
    if (cycleRevenue > 0) {
        gameState.balance += cycleRevenue;
        gameState.dailyRevenue += cycleRevenue;
        
        // Log the transaction
        logTransaction({
            type: 'revenue_collection',
            amount: cycleRevenue,
            description: 'Cycle revenue collection',
            category: 'revenue'
        });
        
        if (cycleRevenue >= 1) {
            addActionToLog(`üí∞ Revenue collected: TTD $${cycleRevenue.toLocaleString('en-US', {minimumFractionDigits: 2})}`, "success");
        }
    }
    
    gameState.completedCyclesToday++;
    gameState.totalMinutesPassed = (gameState.totalMinutesPassed || 0) + 2;
    
    updateTimePassedDisplay();
    
    if (gameState.completedCyclesToday >= DAY_CYCLES) {
        resetDaily();
    }
    
    gameState.lastUpdate = Date.now();
    gameState.currentCycleStart = Date.now();
    
    updateDashboard();
    autoSave();
}

        function resetDaily() {
            
            applyAccountingFees();

            paySalaries();
            
            processLoanRepayments();
            
            const previousRevenue = gameState.dailyRevenue;
            const previousExpenses = gameState.dailyExpenses;
            
            gameState.totalRevenueHistory = (gameState.totalRevenueHistory || 0) + previousRevenue;
            gameState.totalExpenseHistory = (gameState.totalExpenseHistory || 0) + previousExpenses;
            
            gameState.dailyRevenue = 0;
            gameState.dailyExpenses = 0;
            gameState.completedCyclesToday = 0;
            gameState.gameDay++;
            
            addActionToLog(`üìÖ Day ${gameState.gameDay-1} Summary: Revenue: TTD $${previousRevenue.toLocaleString('en-US', {minimumFractionDigits: 2})}`, "info");
            addActionToLog(`üìÖ New game day! Day ${gameState.gameDay} started.`, "success");
            
            updateDashboard();
        }

        function paySalaries() {
    let totalSalary = 0;
    
    // Pay executive salaries
    staffConfig.forEach(employee => {
        const employeeState = gameState.staff[employee.id];
        if (employeeState && employeeState.hired) {
            const annualSalary = employeeState.currentSalary || employee.baseSalary;
            const dailySalary = annualSalary / 365;
            totalSalary += dailySalary;
            
            logTransaction({
                type: 'salary_payment',
                amount: -dailySalary,
                description: `Daily salary: ${employee.name}`,
                category: 'operating_expense'
            });
        }
    });
    
    // Pay staff member salaries
    if (gameState.staffMembers && gameState.staffMembers.length > 0) {
        gameState.staffMembers.forEach(staff => {
            if (staff.hired) {
                const dailySalary = staff.dailySalary || (staff.annualSalary / 365);
                totalSalary += dailySalary;
                
                logTransaction({
                    type: 'salary_payment',
                    amount: -dailySalary,
                    description: `Daily salary: ${staff.name}`,
                    category: 'operating_expense'
                });
            }
        });
    }
    
    if (totalSalary > 0) {
        if (gameState.balance >= totalSalary) {
            gameState.dailyExpenses += totalSalary;
            gameState.balance -= totalSalary;
            
            addActionToLog(`üí∏ Daily salaries paid: TTD $${totalSalary.toLocaleString('en-US', {minimumFractionDigits: 2})}`, "info");
        } else {
            logTransaction({
                type: 'salary_unpaid',
                amount: -totalSalary,
                description: `Unpaid daily salaries (insufficient funds)`,
                category: 'operating_expense'
            });
            
            addActionToLog(`‚ùå Insufficient funds to pay salaries! Need TTD $${totalSalary.toLocaleString('en-US', {minimumFractionDigits: 2})}`, "danger");
        }
    }
}

        
 // ============================================
// AUTO-SAVE SYSTEM (FIXED)
// ============================================

// Store intervals in a dedicated object
const saveIntervals = {
    autoSave: null,
    countdown: null
};

// Initialize Auto Save
function initAutoSave() {
    console.log("üîÑ Initializing auto-save system...");
    
    // Clear any existing intervals
    cleanupAutoSave();
    
    // Set up auto-save interval (4 minutes)
    saveIntervals.autoSave = setInterval(autoSave, AUTO_SAVE_INTERVAL);
    
    // Track last auto-save time
    gameState.lastAutoSave = Date.now();
    
    // Initial save after 4 seconds
    const initialSaveTimer = setTimeout(() => {
        console.log("üíæ Performing initial auto-save...");
        autoSave();
        clearTimeout(initialSaveTimer);
    }, 2000);
    
    console.log("‚úÖ Auto-save enabled: Every 4 minutes");
    
    // Start the auto-save countdown display
    updateAutoSaveCountdown();
    
    // Update countdown every minute
    saveIntervals.countdown = setInterval(updateAutoSaveCountdown, 60000);
    
    // Add cleanup on page unload
    window.addEventListener('beforeunload', cleanupAutoSave);
}

// Clean up all intervals
function cleanupAutoSave() {
    if (saveIntervals.autoSave) {
        clearInterval(saveIntervals.autoSave);
        saveIntervals.autoSave = null;
    }
    if (saveIntervals.countdown) {
        clearInterval(saveIntervals.countdown);
        saveIntervals.countdown = null;
    }
}

// Update auto-save countdown display
function updateAutoSaveCountdown() {
    const statusElement = document.getElementById('auto-save-status');
    if (!statusElement) return;
    
    const lastSave = gameState.lastAutoSave || Date.now();
    const nextSave = lastSave + AUTO_SAVE_INTERVAL;
    const timeUntilNext = nextSave - Date.now();
    const minutesUntilNext = Math.max(0, Math.ceil(timeUntilNext / 60000));
    
    if (minutesUntilNext > 0) {
        statusElement.textContent = `Auto-save in: ${minutesUntilNext} minute${minutesUntilNext !== 1 ? 's' : ''}`;
        statusElement.style.color = 'rgba(255,255,255,0.8)';
    } else {
        statusElement.textContent = 'Auto-save: About to save...';
        statusElement.style.color = 'var(--warning)';
    }
}

// Auto Save function
function autoSave() {
    console.log(`üíæ Auto-saving at ${new Date().toLocaleTimeString()}`);
    
    // Update last auto-save time
    gameState.lastAutoSave = Date.now();
    gameState.lastUpdate = Date.now();
    
    // Save to localStorage
    localStorage.setItem('financialTycoonGame', JSON.stringify(gameState));
    
    // Update status indicator
    const statusElement = document.getElementById('auto-save-status');
    if (statusElement) {
        const now = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        statusElement.textContent = `Auto-saved at ${now}`;
        statusElement.style.color = 'var(--success)';
        
        // Update countdown after a moment
        setTimeout(updateAutoSaveCountdown, 2000);
    }
    
    // Occasionally log auto-save (30% chance to avoid spam)
    const shouldLog = Math.random() < 0.3;
    if (shouldLog) {
        addActionToLog('üíæ Game auto-saved', "info");
    }
}

// Save Game (manual)
function saveGame() {
    gameState.lastUpdate = Date.now();
    gameState.lastAutoSave = Date.now(); // Also update auto-save time
    localStorage.setItem('financialTycoonGame', JSON.stringify(gameState));
    
    addActionToLog('üíæ Game saved manually!', "success");
    showNotification('üíæ Game saved manually!', 'success');
    
    // Update the auto-save status indicator
    const statusElement = document.getElementById('auto-save-status');
    if (statusElement) {
        const now = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        statusElement.textContent = `Manually saved at ${now}`;
        statusElement.style.color = 'var(--accent)';
        
        // Update countdown after a moment
        setTimeout(updateAutoSaveCountdown, 2000);
    }
}

        // ============================================
        // RENDERING FUNCTIONS
        // ============================================

        // Update dashboard
        function updateDashboard() {
            const mainBalanceElement = document.getElementById('main-balance');
            if (mainBalanceElement) {
                mainBalanceElement.textContent = 
                    `TTD $${gameState.balance.toLocaleString('en-US', {minimumFractionDigits: 2})}`;
            }
            
            const dailyRevenueElement = document.getElementById('daily-revenue');
            if (dailyRevenueElement) {
                dailyRevenueElement.textContent = 
                    `TTD $${gameState.dailyRevenue.toLocaleString('en-US', {minimumFractionDigits: 2})}`;
            }
            
            const dailyExpensesElement = document.getElementById('daily-expenses');
            if (dailyExpensesElement) {
                dailyExpensesElement.textContent = 
                    `TTD $${gameState.dailyExpenses.toLocaleString('en-US', {minimumFractionDigits: 2})}`;
            }
            
            const netProfit = gameState.dailyRevenue - gameState.dailyExpenses;
            const netProfitElement = document.getElementById('net-profit');
            if (netProfitElement) {
                netProfitElement.textContent = 
                    `TTD $${netProfit.toLocaleString('en-US', {minimumFractionDigits: 2})}`;
            }
            
            const profitMargin = gameState.dailyRevenue > 0 ? 
                ((netProfit / gameState.dailyRevenue) * 100) : 0;
            const profitMarginElement = document.getElementById('profit-margin');
            if (profitMarginElement) {
                profitMarginElement.textContent = 
                    `${profitMargin.toFixed(1)}%`;
                profitMarginElement.className = 
                    `stat-value ${profitMargin >= 0 ? 'positive' : 'negative'}`;
            }
            
            let totalClients = 0;
            clientSegmentsConfig.forEach(client => {
                const clientState = gameState.clients[client.id];
                if (clientState) totalClients += clientState.acquired || 0;
            });
            const activeClientsElement = document.getElementById('active-clients');
            if (activeClientsElement) activeClientsElement.textContent = totalClients;
            
            let activeServices = 0;
            servicesConfig.forEach(service => {
                const serviceState = gameState.services[service.id];
                if (serviceState && serviceState.active === true) activeServices++;
            });
            // Add Development Consultancy if active
            if (gameState.developmentConsultancy && gameState.developmentConsultancy.active) {
                activeServices++;
            }
            const activeServicesElement = document.getElementById('active-services');
            if (activeServicesElement) activeServicesElement.textContent = activeServices;
            
            // Update staff counts
            const totalStaff = calculateAvailableStaff();
            const requiredStaff = calculateTotalStaffRequired();
            const totalStaffElement = document.getElementById('total-staff');
            const staffRequiredElement = document.getElementById('staff-required');
            
            if (totalStaffElement) totalStaffElement.textContent = totalStaff;
            if (staffRequiredElement) {
                staffRequiredElement.textContent = requiredStaff;
                staffRequiredElement.className = `stat-value ${totalStaff >= requiredStaff ? 'positive' : 'negative'}`;
            }
            
            // Update staffing status display
            updateStaffingStatusDisplay();
            
            const companyValue = calculateCompanyValue();
            const companyValueElement = document.getElementById('company-value');
            if (companyValueElement) {
                companyValueElement.textContent = 
                    `TTD $${companyValue.toLocaleString('en-US', {minimumFractionDigits: 2})}`;
            }
        }

        // Calculate company value
        function calculateCompanyValue() {
            let value = gameState.balance;
            
            let totalInvestments = 0;
            investmentsConfig.forEach(investment => {
                const investmentState = gameState.investments[investment.id];
                if (investmentState) totalInvestments += investmentState.currentInvestment || 0;
            });
            value += totalInvestments;
            
            let loanPortfolioValue = 0;
            if (gameState.loans && gameState.loans.length > 0) {
                gameState.loans.forEach(loan => {
                    if (!loan.paidOff && !loan.defaulted) {
                        loanPortfolioValue += loan.amount * 0.9;
                    }
                });
            }
            value += loanPortfolioValue;
            
            let clientValue = 0;
            clientSegmentsConfig.forEach(client => {
                const clientState = gameState.clients[client.id];
                if (clientState && clientState.acquired > 0) {
                    const multiplier = gameState.gameDay > 7 ? 1.25 : 1.0;
                    clientValue += clientState.acquired * client.cost * multiplier;
                }
            });
            value += clientValue;
            
            let staffValue = 0;
            
            staffConfig.forEach(employee => {
                const employeeState = gameState.staff[employee.id];
                if (employeeState && employeeState.hired) {
                    const annualSalary = employeeState.currentSalary || employee.baseSalary;
                    if (gameState.gameDay <= 7) {
                        staffValue += annualSalary * 0.1;
                    } else if (gameState.gameDay <= 30) {
                        staffValue += annualSalary * 0.25;
                    } else {
                        staffValue += annualSalary * 0.5;
                    }
                }
            });
            
            if (gameState.staffMembers && gameState.staffMembers.length > 0) {
                gameState.staffMembers.forEach(staff => {
                    if (staff.hired) {
                        const daysEmployed = gameState.gameDay - (staff.hireDate || gameState.gameDay);
                        const experienceBonus = Math.min(daysEmployed * 50, 5000);
                        staffValue += staff.hiringCost + experienceBonus;
                    }
                });
            }
            value += staffValue;
            
            // Add Development Consultancy value
            if (gameState.developmentConsultancy && gameState.developmentConsultancy.active) {
                const consultancyValue = gameState.developmentConsultancy.totalRevenue * 0.5;
                value += consultancyValue;
            }
            
            let goodwill = 0;
            const dailyProfit = gameState.dailyRevenue - gameState.dailyExpenses;
            
            if (!gameState.profitHistory) gameState.profitHistory = [];
            gameState.profitHistory.push(dailyProfit);
            
            if (gameState.profitHistory.length > 30) {
                gameState.profitHistory.shift();
            }
            
            let avgDailyProfit = 0;
            if (gameState.profitHistory.length > 0) {
                const totalProfit = gameState.profitHistory.reduce((a, b) => a + b, 0);
                avgDailyProfit = totalProfit / gameState.profitHistory.length;
            }
            
            if (gameState.gameDay > 7 && avgDailyProfit > 0) {
                goodwill = avgDailyProfit * 90;
            }
            
            const tangibleAssets = gameState.balance + totalInvestments + loanPortfolioValue + clientValue;
            goodwill = Math.min(goodwill, tangibleAssets * 0.5);
            
            value += Math.max(0, goodwill);
            
            let intangibleValue = 0;
            intangibleValue += gameState.gameDay * 100;
            
            let clientRetentionBonus = 0;
            clientSegmentsConfig.forEach(client => {
                const clientState = gameState.clients[client.id];
                if (clientState && clientState.acquired > 0) {
                    clientRetentionBonus += clientState.acquired * 10;
                }
            });
            intangibleValue += clientRetentionBonus;
            
            if (avgDailyProfit > 0) {
                intangibleValue += avgDailyProfit * 10;
            }
            
            intangibleValue = Math.min(intangibleValue, tangibleAssets * 0.25);
            value += intangibleValue;
            
            return Math.round(value / 100) * 100;
        }

        // Render All Content
        function renderAllContent() {
            renderClients();
            renderServices();
            renderStaff();
            renderInvestments();
            updateDashboard();
            renderLoanManagement();
        }

        // Render clients (MODIFIED TO SHOW STAFF REQUIREMENTS)
        function renderClients() {
            const clientsGrid = document.getElementById('clients-grid');
            if (!clientsGrid) return;
            
            clientsGrid.innerHTML = '';
            
            clientSegmentsConfig.forEach(client => {
                const clientState = gameState.clients[client.id] || { acquired: 0 };
                const card = document.createElement('div');
                card.className = 'card';
                
                const canPurchase = (gameState.balance - client.cost) > -0.001;
                
                // Calculate staff requirements for this client segment
                const requiredStaff = clientState.acquired > 0 ? 
                    Math.max(
                        client.staffRequirements.minStaff || 1,
                        Math.ceil(clientState.acquired * client.staffRequirements.perClient)
                    ) : 0;
                
                // Calculate staff ratio (1:X)
                const staffRatio = Math.round(1 / client.staffRequirements.perClient);
                
                card.innerHTML = `
                    <div class="card-header">
                        <h3 class="card-title">${client.name} <span class="staff-req-badge">1:${staffRatio}</span></h3>
                        <i class="${client.icon} card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Cost to Acquire</span>
                            <span class="stat-value">TTD $${client.cost.toLocaleString()}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Acquired Clients</span>
                            <span class="stat-value">${clientState.acquired}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Required</span>
                            <span class="stat-value neutral">${requiredStaff} staff</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Staff Ratio</span>
                            <span class="stat-value">1 staff : ${staffRatio} clients</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button class="btn ${canPurchase ? 'btn-success' : 'btn-danger'}" 
                                onclick="acquireClient('${client.id}')"
                                ${!canPurchase ? 'disabled' : ''}>
                            <i class="fas fa-user-plus"></i> Acquire Client (TTD $${client.cost.toLocaleString()})
                        </button>
                    </div>
                `;
                clientsGrid.appendChild(card);
            });
        }

        // Render services (INCLUDING CONTRACT SERVICES AND DEVELOPMENT CONSULTANCY)
        function renderServices() {
            const servicesGrid = document.getElementById('services-grid');
            if (!servicesGrid) return;
            
            servicesGrid.innerHTML = '';
            
            // Render core services
            servicesConfig.forEach(service => {
                const serviceState = gameState.services[service.id] || { active: false };
                const isSmeFinancing = service.id === 'smeFinancing';
                
                const card = document.createElement('div');
                card.className = `card ${isSmeFinancing ? 'loan-card' : ''}`;
                
                let cardHTML = `
                    <div class="card-header">
                        <h3 class="card-title">${service.name} ${isSmeFinancing ? '<span class="loan-badge">LOANS</span>' : ''}</h3>
                        <i class="${service.icon} card-icon"></i>
                    </div>
                    <div class="stats">`;
                
                if (isSmeFinancing) {
                    const activeLoans = gameState.loans ? gameState.loans.filter(loan => !loan.paidOff).length : 0;
                    const totalLoanPortfolio = gameState.loans ? gameState.loans.reduce((sum, loan) => sum + (loan.paidOff ? 0 : loan.amount), 0) : 0;
                    
                    cardHTML += `
                        <div class="stat-row">
                            <span class="stat-label">Active Loans</span>
                            <span class="stat-value">${activeLoans}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Loan Portfolio</span>
                            <span class="stat-value positive">TTD $${totalLoanPortfolio.toLocaleString()}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Class A (General Public)</span>
                            <span class="stat-value">TTD $500 - $5,000</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Class B (HNW Individuals)</span>
                            <span class="stat-value">TTD $10,000 - $50,000</span>
                        </div>`;
                } else {
                    cardHTML += `
                        <div class="stat-row">
                            <span class="stat-label">Revenue/Cycle</span>
                            <span class="stat-value positive">TTD $${service.revenue.toLocaleString()}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value ${serviceState.active ? 'positive' : 'negative'}">
                                ${serviceState.active ? 'Active' : 'Inactive'}
                            </span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Cycle Time</span>
                            <span class="stat-value">2 minutes</span>
                        </div>`;
                }
                
                cardHTML += `
                    </div>
                    <div style="margin-top: 1rem;">`;
                
                if (isSmeFinancing) {
                    cardHTML += `
                        <button class="btn ${serviceState.active ? 'btn-warning' : 'btn-primary'}" 
                                onclick="toggleService('${service.id}')">
                            <i class="fas fa-power-off"></i> ${serviceState.active ? 'Deactivate' : 'Activate'}
                        </button>
                        <button class="btn btn-success" onclick="openLoanModal()">
                            <i class="fas fa-hand-holding-usd"></i> Issue New Loan
                        </button>`;
                } else {
                    cardHTML += `
                        <button class="btn ${serviceState.active ? 'btn-warning' : 'btn-primary'}" 
                                onclick="toggleService('${service.id}')">
                            <i class="fas fa-power-off"></i> ${serviceState.active ? 'Deactivate' : 'Activate'}
                        </button>`;
                }
                
                cardHTML += `</div>`;
                card.innerHTML = cardHTML;
                servicesGrid.appendChild(card);
            });
            
            // Render Development Consultancy card
            renderDevelopmentConsultancyCard();
            
            // Render contract services
            contractServicesConfig.forEach(service => {
                const serviceState = gameState.contractServices?.[service.id] || {
                    purchased: false,
                    currentContract: null,
                    contractHistory: [],
                    lastCheck: null,
                    nextAvailable: null,
                    activeUntil: null
                };
                
                const card = document.createElement('div');
                card.className = 'card contract-card';
                
                let cardHTML = `
                    <div class="card-header">
                        <h3 class="card-title">${service.name} <span class="contract-badge">CONTRACT</span></h3>
                        <i class="${service.icon} card-icon"></i>
                    </div>
                    <div class="stats">
                        <div class="stat-row">
                            <span class="stat-label">Purchase Cost</span>
                            <span class="stat-value">TTD $${service.purchaseCost.toLocaleString()}</span>
                        </div>`;
                
                if (serviceState.purchased) {
                    const isActive = serviceState.activeUntil && serviceState.activeUntil > Date.now();
                    const hasContract = serviceState.currentContract;
                    
                    cardHTML += `
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value ${isActive ? 'positive' : (hasContract ? 'warning' : 'neutral')}">
                                ${isActive ? 'Active' : (hasContract ? 'Contract Available' : 'Waiting')}
                            </span>
                        </div>`;
                    
                    if (isActive) {
                        const timeRemaining = serviceState.activeUntil - Date.now();
                        cardHTML += `
                            <div class="stat-row">
                                <span class="stat-label">Time Remaining</span>
                                <span class="stat-value">${formatTime(timeRemaining)}</span>
                            </div>`;
                    } else if (hasContract) {
                        const contract = serviceState.currentContract;
                        cardHTML += `
                            <div class="stat-row">
                                <span class="stat-label">Contract Value</span>
                                <span class="stat-value positive">TTD $${contract.price.toLocaleString()}</span>
                            </div>`;
                    }
                    
                    cardHTML += `
                        <div class="stat-row">
                            <span class="stat-label">Completed Contracts</span>
                            <span class="stat-value">${serviceState.contractHistory.filter(c => c.status === 'completed').length}</span>
                        </div>`;
                } else {
                    cardHTML += `
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">Not Purchased</span>
                        </div>`;
                }
                
                cardHTML += `
                    </div>
                    <div style="margin-top: 1rem;">`;
                
                if (!serviceState.purchased) {
                    // Purchase button
                    cardHTML += `
                        <button class="btn ${gameState.balance >= service.purchaseCost ? 'btn-success' : 'btn-danger'}" 
                                onclick="purchaseContractService('${service.id}')"
                                ${gameState.balance < service.purchaseCost ? 'disabled' : ''}>
                            <i class="fas fa-shopping-cart"></i> Purchase Service (TTD $${service.purchaseCost.toLocaleString()})
                        </button>`;
                } else {
                    // Check requirements
                    const requirementsMet = checkServiceRequirements(service.id);
                    const isActive = serviceState.activeUntil && serviceState.activeUntil > Date.now();
                    const hasContract = serviceState.currentContract;
                    const activeCount = getActiveContractsCount();
                    
                    if (isActive) {
                        // Active contract - show progress
                        const timeRemaining = serviceState.activeUntil - Date.now();
                        const progressPercent = 100 - (timeRemaining / CONTRACT_DURATION * 100);
                        
                        cardHTML += `
                            <div class="contract-progress">
                                <div class="contract-progress-fill" style="width: ${progressPercent}%"></div>
                            </div>
                            <div class="contract-timer">
                                <i class="fas fa-clock"></i>
                                Active for: ${formatTime(timeRemaining)}
                            </div>`;
                    } else if (hasContract) {
                        // Contract available
                        const contract = serviceState.currentContract;
                        const canAccept = activeCount < 2;
                        
                        cardHTML += `
                            <div class="contract-offer">
                                <div class="contract-client">
                                    <i class="fas fa-building"></i>
                                    ${contract.clientName}
                                </div>
                                <div class="contract-price">
                                    TTD $${contract.price.toLocaleString()}
                                </div>
                                <div class="contract-timer">
                                    <i class="fas fa-hourglass-half"></i>
                                    Expires in: ${formatTime(contract.expiresAt - Date.now())}
                                </div>
                                <div class="contract-actions">
                                    <button class="btn ${canAccept ? 'btn-success' : 'btn-warning'}" 
                                            onclick="acceptContract('${service.id}')"
                                            ${!canAccept ? 'title="Maximum 2 active contracts reached"' : ''}>
                                        <i class="fas fa-check"></i> Accept
                                    </button>
                                    <button class="btn btn-danger" onclick="rejectContract('${service.id}')">
                                        <i class="fas fa-times"></i> Reject
                                    </button>
                                </div>
                            </div>`;
                    } else if (!requirementsMet) {
                        // Requirements not met
                        cardHTML += `
                            <div class="availability-check unavailable">
                                <i class="fas fa-times-circle"></i>
                                Requirements not met
                            </div>
                            <button class="btn btn-primary" onclick="showRequirements('${service.id}')">
                                <i class="fas fa-info-circle"></i> View Requirements
                            </button>`;
                    } else {
                        // Waiting for next contract
                        const nextCheck = serviceState.nextAvailable || Date.now() + CONTRACT_CHECK_INTERVAL;
                        const timeUntilNext = nextCheck - Date.now();
                        
                        if (timeUntilNext > 0) {
                            cardHTML += `
                                <div class="contract-timer">
                                    <i class="fas fa-clock"></i>
                                    Next contract in: ${formatTime(timeUntilNext)}
                                </div>`;
                        } else {
                            cardHTML += `
                                <div class="availability-check available">
                                    <i class="fas fa-check-circle"></i>
                                    Checking for contracts...
                                </div>`;
                        }
                    }
                    
                    // View history button
                    cardHTML += `
                        <button class="btn btn-accent" onclick="showContractHistory('${service.id}')" style="margin-top: 0.5rem;">
                            <i class="fas fa-history"></i> View History
                        </button>`;
                }
                
                cardHTML += `</div>`;
                card.innerHTML = cardHTML;
                servicesGrid.appendChild(card);
            });
        }

        // Render staff
        function renderStaff() {
            const staffGrid = document.getElementById('staff-grid');
            if (!staffGrid) return;
            
            staffGrid.innerHTML = '';
            
            // Render executive staff
            staffConfig.forEach(employee => {
                const employeeState = gameState.staff[employee.id] || { 
                    hired: employee.id === 'ceo', 
                    currentSalary: employee.baseSalary
                };
                
                const isCEO = employee.id === 'ceo';
                const currentSalary = employeeState.currentSalary || employee.baseSalary;
                const dailySalary = currentSalary / 365;
                
                const card = document.createElement('div');
                card.className = `card ${isCEO ? 'ceo-card' : ''}`;
                
                let cardHTML = `
                    <div class="card-header">
                        <h3 class="card-title">${employee.name}</h3>
                        <i class="${employee.icon} card-icon"></i>
                    </div>
                    <div class="stats">`;
                
                if (employeeState.hired) {
                    cardHTML += `
                        <div class="stat-row">
                            <span class="stat-label">Role</span>
                            <span class="stat-value">${employee.role.toUpperCase()}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Annual Salary</span>
                            <span class="stat-value">TTD $${currentSalary.toLocaleString()}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Daily Cost</span>
                            <span class="stat-value">TTD $${dailySalary.toLocaleString('en-US', {minimumFractionDigits: 3})}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value positive">Hired</span>
                        </div>`;
                } else {
                    cardHTML += `
                        <div class="stat-row">
                            <span class="stat-label">Role</span>
                            <span class="stat-value">${employee.role.toUpperCase()}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Hiring Cost</span>
                            <span class="stat-value">TTD $${employee.hiringCost.toLocaleString()}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Annual Salary</span>
                            <span class="stat-value">TTD $${employee.baseSalary.toLocaleString()}</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Status</span>
                            <span class="stat-value negative">Available</span>
                        </div>`;
                }
                
                cardHTML += `
                    </div>
                    <div style="margin-top: 1rem;">
                        ${isCEO ? 
                            `<button class="btn btn-accent" onclick="updateCeoSalary()">
                                <i class="fas fa-edit"></i> Set My Salary
                            </button>` :
                            `<button class="btn ${employeeState.hired ? 'btn-danger' : 'btn-success'}" 
                                    onclick="toggleEmployee('${employee.id}')"
                                    ${!employeeState.hired && gameState.balance < employee.hiringCost ? 'disabled' : ''}>
                                <i class="fas fa-${employeeState.hired ? 'user-slash' : 'user-plus'}"></i>
                                ${employeeState.hired ? 'Fire' : 'Hire (TTD $' + employee.hiringCost.toLocaleString() + ')'}
                            </button>`
                        }
                    </div>
                `;
                
                card.innerHTML = cardHTML;
                staffGrid.appendChild(card);
            });
            
            // Render staff members
            if (gameState.staffMembers && gameState.staffMembers.length > 0) {
                const availableStaffMembers = gameState.staffMembers.filter(staff => !staff.removed);
                
                if (availableStaffMembers.length > 0) {
                    availableStaffMembers.forEach((staffMember, index) => {
                        const card = document.createElement('div');
                        card.className = 'card staff-member-card';
                        
                        // Use staff member's own values with reasonable defaults
            const annualSalary = staffMember.annualSalary || 9000; // Default to 9000
            const dailySalary = staffMember.dailySalary || (annualSalary / 365);
            const revenueContribution = staffMember.revenueContribution || 
                       (staffMember.name.includes('Temp') ? 0.002 : 0.005); // 0.2% for temp, 0.5% for regular;
                        
                        let cardHTML = `
                            <div class="card-header">
                                <h3 class="card-title">${staffMember.name}</h3>
                                <i class="${staffMember.icon} card-icon"></i>
                            </div>`;
                        
                        if (staffMember.hired) {
                            cardHTML += `<div class="boost-badge"><i class="fas fa-chart-line"></i> +${(revenueContribution * 100).toFixed(0)}% Revenue</div>`;
                        }
                        
                        cardHTML += `
                            <div class="stats">
                                <div class="stat-row">
                                    <span class="stat-label">Role</span>
                                    <span class="stat-value">OPERATIONS</span>
                                </div>
                                <div class="stat-row">
                                    <span class="stat-label">Annual Salary</span>
                                    <span class="stat-value">TTD $${annualSalary.toLocaleString('en-US', {minimumFractionDigits: 2})}</span>
                                </div>
                                <div class="stat-row">
                                    <span class="stat-label">Daily Cost</span>
                                    <span class="stat-value">TTD $${dailySalary.toLocaleString('en-US', {minimumFractionDigits: 3})}</span>
                                </div>`;
                        
                        if (staffMember.hired) {
                            cardHTML += `
                                <div class="stat-row">
                                    <span class="stat-label">Revenue Boost</span>
                                    <span class="stat-value positive">+${(revenueContribution * 100).toFixed(0)}%</span>
                                </div>
                                <div class="stat-row">
                                    <span class="stat-label">Status</span>
                                    <span class="stat-value positive">Hired</span>
                                </div>`;
                        } else {
                            cardHTML += `
                                <div class="stat-row">
                                    <span class="stat-label">Hiring Cost</span>
                                    <span class="stat-value">TTD $${staffMember.hiringCost.toLocaleString()}</span>
                                </div>
                                <div class="stat-row">
                                    <span class="stat-label">Status</span>
                                    <span class="stat-value negative">Available</span>
                                </div>`;
                        }
                        
                        cardHTML += `
                            </div>
                            <div style="margin-top: 1rem;">`;
                        
                        if (!staffMember.hired) {
                            cardHTML += `
                                <button class="btn ${gameState.balance >= staffMember.hiringCost ? 'btn-success' : 'btn-danger'}" 
                                        onclick="toggleStaffMember(${gameState.staffMembers.indexOf(staffMember)})"
                                        ${gameState.balance < staffMember.hiringCost ? 'disabled' : ''}>
                                    <i class="fas fa-user-plus"></i> Hire (TTD $${staffMember.hiringCost.toLocaleString()})
                                </button>`;
                        } else {
                            cardHTML += `
                                <button class="btn btn-danger" onclick="removeStaffMember(${gameState.staffMembers.indexOf(staffMember)})">
                                    <i class="fas fa-user-slash"></i> Fire/Permanently Remove
                                </button>
                                <button class="btn btn-primary" onclick="adjustStaffSalary(${gameState.staffMembers.indexOf(staffMember)})">
                                    <i class="fas fa-edit"></i> Adjust Salary
                                </button>`;
                        }
                        
                        cardHTML += `</div>`;
                        card.innerHTML = cardHTML;
                        staffGrid.appendChild(card);
                    });
                }
            }
        }


      

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================

        // Show Notification
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notification-container');
            if (!container) return;
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                warning: 'fas fa-exclamation-triangle',
                danger: 'fas fa-times-circle',
                info: 'fas fa-info-circle'
            };
            
            notification.innerHTML = `
                <i class="${icons[type] || icons.info}" 
                   style="color: ${type === 'success' ? 'var(--success)' : 
                                  type === 'warning' ? 'var(--warning)' : 
                                  type === 'danger' ? 'var(--danger)' : 'var(--secondary)'};"></i>
                <div style="flex: 1;">${message}</div>
                <button class="close-modal" onclick="this.parentElement.remove()" style="font-size: 1.2rem;">&times;</button>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement === container) {
                    notification.style.animation = 'slideInRight 0.3s ease reverse';
                    setTimeout(() => {
                        if (notification.parentElement === container) {
                            container.removeChild(notification);
                        }
                    }, 300);
                }
            }, 5000);
        }

        // Load Game
        function loadGame() {
            const savedGame = localStorage.getItem('financialTycoonGame');
            if (!savedGame) {
                showNotification('‚ùå No saved game found', 'danger');
                return;
            }
            
            if (confirm('Load saved game? Current progress will be lost.')) {
                gameState = JSON.parse(savedGame);

                processTimePassed();
                renderAllContent();
                updateCompanyDisplay();
                updateTimePassedDisplay();
                renderActionsLog();
                initContractServices();
                initDevelopmentConsultancy();
                
                // Initialize auto-save system after loading
                if (!window.autoSaveInterval) {
                    initAutoSave();
                } else {
                    updateAutoSaveCountdown(); // Just update the display
                }
                
                // Update loan statistics
                updateLoanStatistics();
                
                addActionToLog('üéÆ Game loaded successfully!', "success");
                showNotification('üéÆ Game loaded successfully!', 'success');
            }
        }

       function resetGame() {
    if (confirm("‚ö†Ô∏è Are you sure you want to reset the game?\n\nThis will delete ALL progress and start fresh.\n\nCustomizations (company name, logo, CEO title) will be kept.")) {
        
        // Save customization data
        const companyName = gameState.companyName;
        const ceoTitle = gameState.ceoTitle;
        const logoType = gameState.logoType;
        const logoValue = gameState.logoValue;
        
        // COMPLETELY reset game state
        gameState = {
            // Core financials - START FRESH
            balance: 1000.00,
            dailyRevenue: 0,
            dailyExpenses: 0,
            gameDay: 1,
            
            // Timing - START FRESH
            lastUpdate: Date.now(),
            currentCycleStart: Date.now(),
            completedCyclesToday: 0,
            totalMinutesPassed: 0,
            
            // Auto-save tracking
            lastAutoSave: Date.now(),
            
            // Company info (keep customizations)
            companyName: companyName,
            ceoTitle: ceoTitle,
            logoType: logoType,
            logoValue: logoValue,
            
            // RESET ALL GAME DATA TO EMPTY
            clients: {},
            services: {},
            investments: {},
            loans: [],
            staffMembers: [],
            
            // Staff - Keep only CEO
            staff: {
                ceo: {
                    hired: true,
                    currentSalary: 0
                }
            },
            
            // Development Consultancy - RESET
            developmentConsultancy: {
                active: false,
                managerAssigned: false,
                activeContracts: [],
                contractHistory: [],
                totalRevenue: 0,
                totalExpense: 0,
                totalPenalties: 0,
                lastContractCheck: Date.now()
            },
            
            // Contract Services - RESET
            contractServices: {},
            contractTimers: {},
            
            // Financial Ledger - RESET
            financialLedger: [],
            dailyTransactionLog: {},
            
            // Actions Log - Keep only reset message
            actionsLog: [],
            
            // Valuation data - RESET
            profitHistory: [],
            totalRevenueHistory: 0,
            totalExpenseHistory: 0
        };
        
        // Initialize contract services structure
        contractServicesConfig.forEach(service => {
            gameState.contractServices[service.id] = {
                purchased: false,
                currentContract: null,
                contractHistory: [],
                lastCheck: null,
                nextAvailable: null,
                activeUntil: null
            };
        });
        
        // Save to storage
        localStorage.setItem('financialTycoonGame', JSON.stringify(gameState));
        
        // RE-INITIALIZE GAME WITHOUT PAGE RELOAD
        softResetGame();
        
        // Show notification
        showNotification("üîÑ Game COMPLETELY reset! Starting fresh with TTD $1,000.", "success");
        console.log("‚úÖ Game completely reset to initial state");
    }
}

// SOFT RESET - preserves UI structure
function softResetGame() {
    // 1. Clear timers
    cleanupAutoSave();
    if (window.consultancyTimer) {
        clearInterval(window.consultancyTimer);
        window.consultancyTimer = null;
    }
    
    // 2. Reset game state values (already done above)
    // 3. Update UI using EXISTING render functions
    
    // Update dashboard stats
    updateDashboard();
    
    // Update company display
    updateCompanyDisplay();
    
    // Update time display
    updateTimePassedDisplay();
    
    // Clear and update actions log
    gameState.actionsLog = [];
    addActionToLog("üîÑ Game COMPLETELY reset! Starting fresh with TTD $1,000.", "success");
    renderActionsLog();
    
    // Re-render all tabs using existing functions
    renderClients();        // This will show all clients as "0 acquired"
    renderServices();       // This will show all services as "Inactive"
    renderStaff();          // This will show all staff options (CEO + other staff available for hire)
    
    // Clear reports tab
    const reportContent = document.getElementById('report-content');
    if (reportContent) {
        reportContent.innerHTML = '<p style="text-align: center; padding: 2rem; color: var(--text-light);">No financial data available. Play the game to generate reports.</p>';
    }
    
    // Reset investments (if you have this function)
    if (typeof renderInvestments === 'function') {
        renderInvestments();
    }
    
    // Reset consultancy card
    if (typeof renderDevelopmentConsultancyCard === 'function') {
        renderDevelopmentConsultancyCard();
    }
    
    // Close any open modals
    closeModal('salaryModal');
    closeModal('statementModal');
    closeModal('companyModal');
    closeModal('requirementsModal');
    closeModal('historyModal');
    closeModal('loanReportModal');
    closeModal('consultancyModal');
    
    // Make sure we're on dashboard tab
    openTab('dashboard');
    
    // Restart game systems
    processTimePassed();
    
    // Restart auto-save
    initAutoSave();
    
    // Restart consultancy timer if needed
    if (typeof initDevelopmentConsultancy === 'function') {
        initDevelopmentConsultancy();
    }
    
    // Force a visual update
    setTimeout(() => {
        // Trigger a small animation to show reset
        const balanceElement = document.getElementById('main-balance');
        if (balanceElement) {
            balanceElement.style.transform = 'scale(1.1)';
            setTimeout(() => {
                balanceElement.style.transform = 'scale(1)';
            }, 300);
        }
    }, 100);
}




        // Update real time
        function updateRealTime() {
            const now = new Date();
            const formatter = new Intl.DateTimeFormat('en-TT', {
                timeZone: 'America/Port_of_Spain',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });
            
            const dateFormatter = new Intl.DateTimeFormat('en-TT', {
                timeZone: 'America/Port_of_Spain',
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            const realTimeElement = document.getElementById('real-time');
            const realDateElement = document.getElementById('real-date');
            
            if (realTimeElement) realTimeElement.textContent = formatter.format(now);
            if (realDateElement) realDateElement.textContent = dateFormatter.format(now);
        }

//Client Acqusition 
        function acquireClient(clientId) {
    const client = clientSegmentsConfig.find(c => c.id === clientId);
    
    if (!client || (gameState.balance - client.cost) < -0.001) {
        showNotification(`‚ùå Need TTD $${client.cost.toLocaleString()} to acquire ${client.name}`, 'danger');
        return;
    }
    
    gameState.balance -= client.cost;
    gameState.dailyExpenses += client.cost;
    
    // ADD THIS LINE:
    logTransaction({
        type: 'client_acquisition',
        amount: -client.cost,
        description: `Acquired ${client.name} client`,
        category: 'client_cost'
    });
    
    if (!gameState.clients[clientId]) {
        gameState.clients[clientId] = { acquired: 1 };
    } else {
        gameState.clients[clientId].acquired = (gameState.clients[clientId].acquired || 0) + 1;
    }
    
    client.services.forEach(serviceId => {
        if (!gameState.services[serviceId]) {
            gameState.services[serviceId] = { active: true };
        } else {
            gameState.services[serviceId].active = true;
        }
    });
    
    updateDashboard();
    renderClients();
    renderServices();
    
    addActionToLog(`‚úÖ Acquired ${client.name} client! Services activated.`, "success");
    showNotification(`‚úÖ Acquired ${client.name} client! Services activated.`, 'success');
    
    autoSave();
}

        // Toggle service
        function toggleService(serviceId) {
            if (!gameState.services[serviceId]) {
                gameState.services[serviceId] = { active: true };
            } else {
                gameState.services[serviceId].active = !gameState.services[serviceId].active;
            }
            
            const service = servicesConfig.find(s => s.id === serviceId);
            renderServices();
            updateDashboard();
            
            const expectedRevenue = calculateCycleRevenue();
            
            addActionToLog(`${service.name} ${gameState.services[serviceId].active ? 'activated' : 'deactivated'}. Expected revenue: TTD $${expectedRevenue.toLocaleString()}/cycle`, 
                          gameState.services[serviceId].active ? "success" : "warning");
            
            autoSave();
        }

        // Toggle employee
        function toggleEmployee(employeeId) {
    if (employeeId === 'ceo') return;
    
    const employee = staffConfig.find(e => e.id === employeeId);
    const employeeState = gameState.staff[employeeId];
    
    if (!employeeState) {
        // Hiring - keep your existing code
        if (gameState.balance < employee.hiringCost) {
            showNotification(`‚ùå Need TTD $${employee.hiringCost.toLocaleString()} to hire ${employee.name}`, 'danger');
            return;
        }
        
        gameState.balance -= employee.hiringCost;
        gameState.dailyExpenses += employee.hiringCost;
        
        // ADD THIS LOG:
        logTransaction({
            type: 'executive_hiring',
            amount: -employee.hiringCost,
            description: `Hired ${employee.name}`,
            category: 'staff_cost'
        });
        
        gameState.staff[employeeId] = { 
            hired: true, 
            currentSalary: employee.baseSalary
        };
        
        addActionToLog(`üëî Hired ${employee.name} for TTD $${employee.hiringCost.toLocaleString()}`, "success");
        showNotification(`üëî Hired ${employee.name} for TTD $${employee.hiringCost.toLocaleString()}`, 'success');
    } else if (employeeState.hired) {
        // ADD TERMINATION COST FOR FIRING EXECUTIVES:
        const annualSalary = employeeState.currentSalary || employee.baseSalary;
        const terminationCost = annualSalary * 0.50;
        
        if (confirm(`Fire ${employee.name}? This will cost TTD $${terminationCost.toLocaleString()} (50% of annual salary) in termination costs.`)) {
            if (gameState.balance >= terminationCost) {
                gameState.balance -= terminationCost;
                gameState.dailyExpenses += terminationCost;
                
                logTransaction({
                    type: 'executive_termination',
                    amount: -terminationCost,
                    description: `Fired ${employee.name} - termination cost`,
                    category: 'operating_expense'
                });
                
                gameState.staff[employeeId].hired = false;
                
                addActionToLog(`üëã Fired ${employee.name}. Termination cost: TTD $${terminationCost.toLocaleString()}`, "warning");
                showNotification(`üëã Fired ${employee.name}. Termination cost: TTD $${terminationCost.toLocaleString()}`, "warning");
            } else {
                showNotification(`‚ùå Cannot fire ${employee.name}. Need TTD $${terminationCost.toLocaleString()} for termination costs.`, 'danger');
                return;
            }
        } else {
            return; // User cancelled
        }
    } else {
        // Re-hiring - keep your existing code
        gameState.staff[employeeId].hired = true;
        
        addActionToLog(`üëî Re-hired ${employee.name}`, "success");
    }
    
    renderStaff();
    updateDashboard();
    autoSave();
}

        // Update CEO salary
        function updateCeoSalary() {
            const currentSalary = gameState.staff.ceo?.currentSalary || 0;
            const newSalary = prompt("Enter your annual salary (TTD):", currentSalary);
            
            if (newSalary && !isNaN(newSalary)) {
                const salary = parseInt(newSalary);
                if (!gameState.staff.ceo) {
                    gameState.staff.ceo = { 
                        hired: true, 
                        currentSalary: salary
                    };
                } else {
                    gameState.staff.ceo.currentSalary = salary;
                }
                
                updateDashboard();
                renderStaff();
                
                addActionToLog(`üí∞ CEO salary set to TTD $${salary.toLocaleString()} annually`, "success");
                showNotification(`üí∞ CEO salary set to TTD $${salary.toLocaleString()} annually (TTD $${(salary/365).toLocaleString('en-US', {minimumFractionDigits: 2})} daily)`, 'success');
                autoSave();
            }
        }

        // Open Salary Modal - FIXED FUNCTION
        function openSalaryModal() {
            const modal = document.getElementById('salaryModal');
            const controls = document.getElementById('salary-controls');
            
            if (!modal || !controls) return;
            
            let html = '<div style="display: flex; flex-direction: column; gap: 1.5rem;">';
            
            // CEO Salary
            html += `
                <div class="form-group">
                    <label class="form-label">üëë CEO/Founder Salary</label>
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <input type="number" id="ceo-salary-input" class="form-input" 
                               value="${gameState.staff.ceo?.currentSalary || 0}" 
                               placeholder="Annual salary in TTD" style="flex: 1;">
                        <button class="btn btn-success" onclick="saveCeoSalary()">
                            <i class="fas fa-save"></i> Set
                        </button>
                    </div>
                    <div style="font-size: 0.9rem; color: var(--text-light); margin-top: 0.5rem;">
                        Daily cost: TTD $${((gameState.staff.ceo?.currentSalary || 0) / 365).toLocaleString('en-US', {minimumFractionDigits: 2})}
                    </div>
                </div>
            `;
            
            // Staff Members
            if (gameState.staffMembers && gameState.staffMembers.length > 0) {
                html += `<div class="form-group">
                    <label class="form-label">üë®‚Äçüíº Staff Members</label>
                    <div style="display: flex; flex-direction: column; gap: 1rem;">`;
                
                gameState.staffMembers.forEach((staffMember, index) => {
                    if (!staffMember.removed) {
                        html += `
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <div style="flex: 1;">
                                    <strong>${staffMember.name}</strong>
                                    <div style="font-size: 0.9rem; color: var(--text-light);">
                                        Current: TTD $${staffMember.annualSalary.toLocaleString()}/year
                                    </div>
                                </div>
                                <input type="number" id="staff-salary-${index}" class="form-input" 
                                       value="${staffMember.annualSalary}" 
                                       placeholder="New salary" style="width: 120px;">
                                <button class="btn btn-primary" onclick="saveStaffSalary(${index})">
                                    <i class="fas fa-save"></i>
                                </button>
                            </div>
                        `;
                    }
                });
                
                html += `</div></div>`;
            }
            
            // Executive Staff
            html += `<div class="form-group">
                <label class="form-label">üëî Executive Staff</label>
                <div style="display: flex; flex-direction: column; gap: 1rem;">`;
            
            staffConfig.forEach(employee => {
                if (employee.id !== 'ceo') {
                    const employeeState = gameState.staff[employee.id];
                    if (employeeState && employeeState.hired) {
                        html += `
                            <div style="display: flex; gap: 0.5rem; align-items: center;">
                                <div style="flex: 1;">
                                    <strong>${employee.name}</strong>
                                    <div style="font-size: 0.9rem; color: var(--text-light);">
                                        Current: TTD $${(employeeState.currentSalary || employee.baseSalary).toLocaleString()}/year
                                    </div>
                                </div>
                                <input type="number" id="exec-salary-${employee.id}" class="form-input" 
                                       value="${employeeState.currentSalary || employee.baseSalary}" 
                                       placeholder="New salary" style="width: 120px;">
                                <button class="btn btn-primary" onclick="saveExecSalary('${employee.id}')">
                                    <i class="fas fa-save"></i>
                                </button>
                            </div>
                        `;
                    }
                }
            });
            
            html += `</div></div>`;
            
            html += `<div style="text-align: center; margin-top: 1rem;">
                <button class="btn btn-success" onclick="closeModal('salaryModal')">
                    <i class="fas fa-check"></i> Done
                </button>
            </div>`;
            
            html += '</div>';
            
            controls.innerHTML = html;
            modal.style.display = 'flex';
        }

        // Save CEO Salary
        function saveCeoSalary() {
            const input = document.getElementById('ceo-salary-input');
            if (!input) return;
            
            const newSalary = parseInt(input.value);
            if (isNaN(newSalary) || newSalary < 0) {
                showNotification("‚ùå Please enter a valid salary amount", "danger");
                return;
            }
            
            if (!gameState.staff.ceo) {
                gameState.staff.ceo = { hired: true, currentSalary: newSalary };
            } else {
                gameState.staff.ceo.currentSalary = newSalary;
            }
            
            addActionToLog(`üí∞ CEO salary set to TTD $${newSalary.toLocaleString()} annually`, "success");
            showNotification(`üí∞ CEO salary updated! Daily cost: TTD $${(newSalary/365).toLocaleString('en-US', {minimumFractionDigits: 2})}`, 'success');
            
            renderStaff();
            autoSave();
        }

        // Save Staff Member Salary
        function saveStaffSalary(index) {
            if (!gameState.staffMembers || index >= gameState.staffMembers.length) return;
            
            const input = document.getElementById(`staff-salary-${index}`);
            if (!input) return;
            
            const newSalary = parseInt(input.value);
            if (isNaN(newSalary) || newSalary < 9000) {
                showNotification("‚ùå Minimum annual salary is TTD $9,000", "danger");
                return;
            }
            
            const staffMember = gameState.staffMembers[index];
            staffMember.annualSalary = newSalary;
            staffMember.dailySalary = newSalary / 365;
            
            // Calculate revenue contribution
            const revenueContribution = 0.005 + (Math.max(0, newSalary - 9000) / 9000) * 0.1;
            staffMember.revenueContribution = Math.min(revenueContribution, 1.0);
            
            addActionToLog(`üí∞ ${staffMember.name} salary increased to TTD $${newSalary.toLocaleString()} annually`, "success");
            showNotification(`üí∞ ${staffMember.name} salary: TTD $${newSalary.toLocaleString()} annually = ${(staffMember.revenueContribution * 100).toFixed(0)}% revenue boost`, "success");
            
            renderStaff();
            autoSave();
        }

        // Save Executive Salary
        function saveExecSalary(employeeId) {
            const input = document.getElementById(`exec-salary-${employeeId}`);
            if (!input) return;
            
            const newSalary = parseInt(input.value);
            if (isNaN(newSalary) || newSalary < 0) {
                showNotification("‚ùå Please enter a valid salary amount", "danger");
                return;
            }
            
            const employee = staffConfig.find(e => e.id === employeeId);
            if (!employee) return;
            
            if (!gameState.staff[employeeId]) {
                gameState.staff[employeeId] = { hired: true, currentSalary: newSalary };
            } else {
                gameState.staff[employeeId].currentSalary = newSalary;
            }
            
            addActionToLog(`üí∞ ${employee.name} salary set to TTD $${newSalary.toLocaleString()} annually`, "success");
            showNotification(`üí∞ ${employee.name} salary updated!`, 'success');
            
            renderStaff();
            autoSave();
        }

        // Invest in
        function investIn(investmentId) {
            const investment = investmentsConfig.find(i => i.id === investmentId);
            if (!investment || gameState.balance < investment.minAmount) return;
            
            gameState.balance -= investment.minAmount;
            gameState.dailyExpenses += investment.minAmount;
            
            if (!gameState.investments[investmentId]) {
                gameState.investments[investmentId] = { currentInvestment: investment.minAmount };
            } else {
                gameState.investments[investmentId].currentInvestment = 
                    (gameState.investments[investmentId].currentInvestment || 0) + investment.minAmount;
            }
            
            updateDashboard();
            renderInvestments();
            
            addActionToLog(`üìà Invested TTD $${investment.minAmount.toLocaleString()} in ${investment.name}`, "success");
            showNotification(`üìà Invested TTD $${investment.minAmount.toLocaleString()} in ${investment.name}`, 'success');
            autoSave();
        }

        // Adjust staff salary - FIXED VERSION
function adjustStaffSalary(index) {
    if (!gameState.staffMembers || index >= gameState.staffMembers.length) return;
    
    const staffMember = gameState.staffMembers[index];
    const currentSalary = staffMember.annualSalary;
    
    // Check if it's a temp staff member
    const isTempStaff = staffMember.name.includes('Temp') || staffMember.annualSalary === 2000;
    const minSalary = isTempStaff ? 2000 : 9000;
    
    const newSalary = prompt(`Enter new annual salary for ${staffMember.name}:\n\nCurrent: TTD $${currentSalary.toLocaleString('en-US', {minimumFractionDigits: 2})}\nMinimum: TTD $${minSalary.toLocaleString()}`, currentSalary.toFixed(0));
    
    if (newSalary && !isNaN(newSalary)) {
        const annualSalary = parseInt(newSalary);
        
        if (annualSalary < minSalary) {
            showNotification(`‚ùå Minimum annual salary for ${isTempStaff ? 'Temp Staff' : 'Staff Member'} is TTD $${minSalary.toLocaleString()}`, "danger");
            return;
        }
        
        // Update staff member
        staffMember.annualSalary = annualSalary;
        staffMember.dailySalary = annualSalary / 365;
        
        // Calculate revenue contribution
        let revenueContribution;
        if (isTempStaff) {
            revenueContribution = 0.002 + (Math.max(0, annualSalary - 2000) / 2000) * 0.05;
        } else {
            revenueContribution = 0.005 + (Math.max(0, annualSalary - 9000) / 9000) * 0.1;
        }
        
        staffMember.revenueContribution = Math.min(revenueContribution, 1.0);
        
        addActionToLog(`üí∞ ${staffMember.name} salary increased to TTD $${annualSalary.toLocaleString()} annually`, "success");
        showNotification(`üí∞ ${staffMember.name} salary: TTD $${annualSalary.toLocaleString()} annually = ${(staffMember.revenueContribution * 100).toFixed(0)}% revenue boost`, "success");
        
        updateDashboard();
        renderStaff();
        autoSave();
    }
}

        // Toggle staff member
        function toggleStaffMember(index) {
            if (!gameState.staffMembers || index >= gameState.staffMembers.length) return;
            
            const staffMember = gameState.staffMembers[index];
            
            if (!staffMember.hired) {
                if (gameState.balance < staffMember.hiringCost) {
                    showNotification(`‚ùå Need TTD $${staffMember.hiringCost.toLocaleString()} to hire Staff Member`, 'danger');
                    return;
                }
                
                gameState.balance -= staffMember.hiringCost;
                gameState.dailyExpenses += staffMember.hiringCost;
                staffMember.hired = true;
                staffMember.hireDate = gameState.gameDay;
                
                addActionToLog(`üëî Hired ${staffMember.name}! Revenue increased by ${(staffMember.revenueContribution * 100).toFixed(0)}%`, "success");
                showNotification(`üëî Hired ${staffMember.name}! Revenue increased by ${(staffMember.revenueContribution * 100).toFixed(0)}%`, 'success');
            } else {
                removeStaffMember(index);
                return;
            }
            
            renderStaff();
            updateDashboard();
            autoSave();
        }

        // Remove staff member
        function removeStaffMember(index) {
    if (!gameState.staffMembers || index >= gameState.staffMembers.length) return;
    
    const staffMember = gameState.staffMembers[index];
    if (!staffMember.hired) {
        showNotification("This staff member is already not hired.", "warning");
        return;
    }
    
    const terminationCost = staffMember.annualSalary * 0.50;
    const message = `Fire ${staffMember.name}? This will:\n‚Ä¢ Permanently remove them\n‚Ä¢ Lose their ${(staffMember.revenueContribution * 100).toFixed(0)}% revenue boost\n‚Ä¢ Cost TTD $${terminationCost.toLocaleString()} (50% of annual salary)`;
    
    if (confirm(message)) {
        if (gameState.balance >= terminationCost) {
            gameState.balance -= terminationCost;
            gameState.dailyExpenses += terminationCost;
            
            logTransaction({
                type: 'termination_cost',
                amount: -terminationCost,
                description: `Termination cost for ${staffMember.name}`,
                category: 'operating_expense'
            });
            
            staffMember.removed = true;
            staffMember.hired = false;
            
            addActionToLog(`üëã Fired ${staffMember.name}. Termination cost: TTD $${terminationCost.toLocaleString()}`, "warning");
            showNotification(`üëã ${staffMember.name} fired. Termination cost: TTD $${terminationCost.toLocaleString()}`, "warning");
        } else {
            showNotification(`‚ùå Cannot fire ${staffMember.name}. Need TTD $${terminationCost.toLocaleString()} for termination costs.`, 'danger');
            return;
        }
        
        updateDashboard();
        renderStaff();
        autoSave();
    }
}

        // Update company name
        function updateCompanyName(newName) {
            gameState.companyName = newName || "Financial Services Tycoon";
            updateCompanyDisplay();
            
            addActionToLog(`üè¢ Company name updated to: ${gameState.companyName}`, "success");
            showNotification(`üè¢ Company name updated to: ${gameState.companyName}`, 'success');
            autoSave();
        }

        // Update CEO title
        function updateCeoTitle(newTitle) {
            gameState.ceoTitle = newTitle || "Founder & CEO";
            updateCompanyDisplay();
            
            addActionToLog(`üëë CEO title updated to: ${gameState.ceoTitle}`, "success");
            showNotification(`üëë CEO title updated to: ${gameState.ceoTitle}`, 'success');
            autoSave();
        }

        // Update company display
        function updateCompanyDisplay() {
            const companyNameElement = document.getElementById('company-name');
            const modalCompanyNameElement = document.getElementById('modal-company-name');
            const modalCeoTitleElement = document.getElementById('modal-ceo-title');
            
            if (companyNameElement) companyNameElement.textContent = gameState.companyName;
            if (modalCompanyNameElement) modalCompanyNameElement.textContent = gameState.companyName;
            if (modalCeoTitleElement) modalCeoTitleElement.textContent = gameState.ceoTitle;
            
            const logoContainer = document.getElementById('company-logo');
            const modalLogo = document.getElementById('modal-logo');
            const logoPreview = document.getElementById('logo-preview');
            
            [logoContainer, modalLogo, logoPreview].forEach(container => {
                if (!container) return;
                
                container.innerHTML = '';
                if (gameState.logoType === 'image' && gameState.logoValue.startsWith('data:')) {
                    const img = document.createElement('img');
                    img.src = gameState.logoValue;
                    img.alt = `${gameState.companyName} Logo`;
                    container.appendChild(img);
                } else if (gameState.logoType === 'emoji') {
                    container.textContent = gameState.logoValue;
                    container.style.fontSize = '2.5rem';
                } else {
                    const icon = document.createElement('i');
                    icon.className = gameState.logoValue || 'fas fa-building';
                    container.appendChild(icon);
                }
            });
        }

        // Upload logo
        function uploadLogo() {
            document.getElementById('logo-upload').click();
        }

        // Handle logo upload
        function handleLogoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.size > 2 * 1024 * 1024) {
                showNotification('‚ùå Logo must be less than 2MB', 'danger');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                gameState.logoType = 'image';
                gameState.logoValue = e.target.result;
                updateCompanyDisplay();
                
                addActionToLog('‚úÖ Company logo uploaded successfully!', "success");
                showNotification('‚úÖ Company logo uploaded successfully!', 'success');
                autoSave();
            };
            reader.readAsDataURL(file);
        }

        // Reset logo
        function resetLogo() {
            gameState.logoType = 'icon';
            gameState.logoValue = 'fas fa-building';
            updateCompanyDisplay();
            
            addActionToLog('‚úÖ Logo reset to default', "success");
            showNotification('‚úÖ Logo reset to default', 'success');
            autoSave();
        }

        // Select logo emoji
        function selectLogoEmoji() {
            const emojis = ['üè¢', 'üè¶', 'üíº', 'üí∞', 'üìä', 'üìà', 'üëë', 'üåü', 'üöÄ', 'üéØ'];
            const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];
            gameState.logoType = 'emoji';
            gameState.logoValue = randomEmoji;
            updateCompanyDisplay();
            
            addActionToLog(`‚úÖ Logo set to ${randomEmoji}`, "success");
            showNotification(`‚úÖ Logo set to ${randomEmoji}`, 'success');
            autoSave();
        }

        // Tab navigation
        function openTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            const selectedTab = document.getElementById(tabName);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            const clickedTab = document.querySelector(`.tab[data-tab="${tabName}"]`);
            if (clickedTab) {
                clickedTab.classList.add('active');
            }
            
            // Special handling for Services tab
            if (tabName === 'services') {
                renderDevelopmentConsultancyCard();
            }
        }

        // Modal functions
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'flex';
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
            }
        }

        // Generate statement
        function generateStatement() {
            const statementContent = document.getElementById('statement-content');
            if (!statementContent) return;
            
            let totalInvestments = 0;
            investmentsConfig.forEach(investment => {
                const investmentState = gameState.investments[investment.id];
                if (investmentState) totalInvestments += investmentState.currentInvestment || 0;
            });
            
            let activeLoans = 0;
            let totalLoanPortfolio = 0;
            let monthlyLoanInterest = 0;
            if (gameState.loans) {
                activeLoans = gameState.loans.filter(loan => !loan.paidOff).length;
                totalLoanPortfolio = gameState.loans.reduce((sum, loan) => sum + (loan.paidOff ? 0 : loan.amount), 0);
                monthlyLoanInterest = gameState.loans
                    .filter(loan => !loan.paidOff && !loan.defaulted)
                    .reduce((sum, loan) => sum + (loan.amount * loan.interestRate / 100 / 12), 0);
            }
            
            const companyValue = calculateCompanyValue();
            const totalAssets = gameState.balance + totalInvestments + totalLoanPortfolio;
            const netIncome = gameState.dailyRevenue - gameState.dailyExpenses;
            const roa = totalAssets > 0 ? (netIncome / totalAssets) * 100 : 0;
            
            let staffCount = 1;
            staffConfig.forEach(employee => {
                const employeeState = gameState.staff[employee.id];
                if (employeeState && employeeState.hired && employee.id !== 'ceo') staffCount++;
            });
            if (gameState.staffMembers) {
                staffCount += gameState.staffMembers.filter(staff => staff.hired).length;
            }
            
            const requiredStaff = calculateTotalStaffRequired();
            const availableStaff = calculateAvailableStaff();
            const staffingStatus = checkAndApplyStaffingPenalty();
            
            // Development Consultancy stats
            const consultancy = gameState.developmentConsultancy || {
                active: false,
                managerAssigned: false,
                activeContracts: [],
                contractHistory: [],
                totalRevenue: 0,
                totalExpense: 0,
                totalPenalties: 0
            };
            
            statementContent.innerHTML = `
                <div class="stats">
                    <div class="stat-row">
                        <span class="stat-label">Company</span>
                        <span class="stat-value">${gameState.companyName}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Report Date</span>
                        <span class="stat-value">${new Date().toLocaleDateString()}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Game Day</span>
                        <span class="stat-value">${gameState.gameDay}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Time Played</span>
                        <span class="stat-value">${Math.floor(gameState.totalMinutesPassed || 0)} minutes</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Staff</span>
                        <span class="stat-value">${staffCount}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Staff Required</span>
                        <span class="stat-value ${availableStaff >= requiredStaff ? 'positive' : 'negative'}">${requiredStaff}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Active Loans</span>
                        <span class="stat-value">${activeLoans}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Loan Portfolio</span>
                        <span class="stat-value">TTD $${totalLoanPortfolio.toLocaleString('en-US', {minimumFractionDigits: 2})}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Monthly Loan Interest</span>
                        <span class="stat-value positive">TTD $${monthlyLoanInterest.toLocaleString('en-US', {minimumFractionDigits: 2})}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Development Consultancy Active</span>
                        <span class="stat-value ${consultancy.active ? 'positive' : 'negative'}">${consultancy.active ? 'Yes' : 'No'}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Consultancy Contracts</span>
                        <span class="stat-value">${consultancy.activeContracts.length} active, ${consultancy.contractHistory.length} completed</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Consultancy Revenue</span>
                        <span class="stat-value positive">TTD $${consultancy.totalRevenue.toLocaleString('en-US', {minimumFractionDigits: 2})}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Total Assets</span>
                        <span class="stat-value positive">TTD $${totalAssets.toLocaleString('en-US', {minimumFractionDigits: 2})}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Company Value</span>
                        <span class="stat-value positive">TTD $${companyValue.toLocaleString('en-US', {minimumFractionDigits: 2})}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Daily Revenue</span>
                        <span class="stat-value positive">TTD $${gameState.dailyRevenue.toLocaleString('en-US', {minimumFractionDigits: 2})}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Daily Expenses</span>
                        <span class="stat-value negative">TTD $${gameState.dailyExpenses.toLocaleString('en-US', {minimumFractionDigits: 2})}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Net Income</span>
                        <span class="stat-value ${netIncome >= 0 ? 'positive' : 'negative'}">
                            TTD $${netIncome.toLocaleString('en-US', {minimumFractionDigits: 2})}
                        </span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Return on Assets</span>
                        <span class="stat-value">${roa.toFixed(2)}%</span>
                    </div>
                    ${staffingStatus.penalty > 0 ? `
                    <div class="stat-row" style="color: var(--warning);">
                        <span class="stat-label">‚ö†Ô∏è Staffing Penalty</span>
                        <span class="stat-value">-${(staffingStatus.penalty * 100).toFixed(0)}% revenue</span>
                    </div>
                    ` : ''}
                </div>
                <div style="margin-top: 1.5rem; text-align: center;">
                    <button class="btn btn-primary" onclick="printStatement()">
                        <i class="fas fa-print"></i> Print Statement
                    </button>
                </div>
            `;
            
            openModal('statementModal');
        }

        // Print statement
        function printStatement() {
            window.print();
        }

              // Hire additional staff member - CHARGE ON CREATION
function hireAdditionalStaffMember(type = 'regular') {
    const template = createStaffMember(type);
    
    // Get the correct cost
    const hiringCost = template.hiringCost; // 200 for temp, 320 for regular
    const staffTypeName = type === 'temp' ? 'Temp Staff' : 'Staff Member';
    
    // Check if player has enough money
    if (gameState.balance < hiringCost) {
        showNotification(`‚ùå Need TTD $${hiringCost.toFixed(2)} to create ${staffTypeName} position`, 'danger');
        return;
    }
    
    // Create the staff member
    const newStaffMember = {
        ...template,
        id: Date.now(),
        hired: true,  // AUTO-HIRE since we're paying now
        hireDate: gameState.gameDay,
        removed: false,
        positionCreationPaid: true
    };
    
    if (!gameState.staffMembers) {
        gameState.staffMembers = [];
    }
    
    // DEDUCT THE MONEY NOW
    gameState.balance -= hiringCost;
    gameState.dailyExpenses += hiringCost;
    
    // Log the transaction
    logTransaction({
    type: 'staff_hiring_cost',  // NEW - matches what the report looks for
    amount: -hiringCost,
    description: `Hired ${newStaffMember.name}`,
    category: 'staff_cost'
});
    
    // Add to staff members
    gameState.staffMembers.push(newStaffMember);
    
    // Update UI
    renderStaff();
    updateDashboard();
    
    // Show success message
    addActionToLog(`üëî Hired ${staffTypeName} for TTD $${hiringCost.toFixed(2)}!`, "success");
    showNotification(`üëî Hired ${staffTypeName}! Revenue increased by ${(newStaffMember.revenueContribution * 100).toFixed(0)}%`, 'success');
    
    autoSave();
}

        // Purchase investment (placeholder)
        function purchaseInvestment(investmentId) {
            showNotification('Investment system coming soon!', 'info');
        }

        // ============================================
        // CONTRACT SERVICES FUNCTIONS (ADDITIONAL)
        // ============================================
        
        function checkServiceRequirements(serviceId) {
            const service = contractServicesConfig.find(s => s.id === serviceId);
            if (!service) return false;
            
            const serviceState = gameState.contractServices[serviceId];
            if (!serviceState || !serviceState.purchased) return false;
            
            // Check staff requirements
            for (const staffId of service.requirements.staff) {
                const staff = gameState.staff[staffId];
                if (!staff || !staff.hired) return false;
            }
            
            // Check client requirements
            let hasRequiredClient = false;
            for (const clientId of service.requirements.clients) {
                const client = gameState.clients[clientId];
                if (client && client.acquired > 0) {
                    hasRequiredClient = true;
                    break;
                }
            }
            
            return hasRequiredClient;
        }

        function generateContract(serviceId) {
            const service = contractServicesConfig.find(s => s.id === serviceId);
            if (!service) return null;
            
            // Get available clients for this service
            const availableClients = [];
            for (const clientId of service.requirements.clients) {
                const client = gameState.clients[clientId];
                if (client && client.acquired > 0) {
                    availableClients.push(clientId);
                }
            }
            
            if (availableClients.length === 0) return null;
            
            // Randomly select a client
            const clientId = availableClients[Math.floor(Math.random() * availableClients.length)];
            const pricing = service.clientPricing[clientId];
            
            // Generate random price (at or above minimum)
            const minPrice = pricing.min;
            const maxPrice = pricing.max;
            const price = Math.floor(Math.random() * (maxPrice - minPrice + 1)) + minPrice;
            
            // Get client name
            const client = clientSegmentsConfig.find(c => c.id === clientId);
            
            return {
                id: Date.now(),
                serviceId: serviceId,
                clientId: clientId,
                clientName: client ? client.name : clientId,
                price: price,
                offeredAt: Date.now(),
                expiresAt: Date.now() + (10 * 60 * 1000), // 10 minutes to accept
                status: 'offered'
            };
        }

        function startContractCheckTimers() {
            contractServicesConfig.forEach(service => {
                const serviceState = gameState.contractServices[service.id];
                if (serviceState && serviceState.purchased) {
                    scheduleNextContractCheck(service.id);
                }
            });
        }

        function scheduleNextContractCheck(serviceId) {
            if (!gameState.contractTimers[serviceId]) {
                gameState.contractTimers[serviceId] = {
                    timer: null,
                    lastCheck: Date.now()
                };
            }
            
            // Clear existing timer
            if (gameState.contractTimers[serviceId].timer) {
                clearTimeout(gameState.contractTimers[serviceId].timer);
            }
            
            // Schedule next check
            gameState.contractTimers[serviceId].timer = setTimeout(() => {
                checkAndOfferContracts();
            }, CONTRACT_CHECK_INTERVAL);
        }

        function checkAndOfferContracts() {
            const purchasedServices = contractServicesConfig.filter(service => {
                const serviceState = gameState.contractServices[service.id];
                return serviceState && serviceState.purchased;
            });
            
            if (purchasedServices.length === 0) return;
            
            // Generate contracts for all purchased services
            const availableContracts = [];
            purchasedServices.forEach(service => {
                if (checkServiceRequirements(service.id)) {
                    const contract = generateContract(service.id);
                    if (contract) {
                        const serviceState = gameState.contractServices[service.id];
                        serviceState.currentContract = contract;
                        serviceState.nextAvailable = Date.now() + CONTRACT_CHECK_INTERVAL;
                        availableContracts.push({
                            service: service,
                            contract: contract
                        });
                    }
                }
            });
            
            // Show notification if contracts are available
            if (availableContracts.length > 0) {
                showNotification(`üìã ${availableContracts.length} contract${availableContracts.length > 1 ? 's' : ''} available! Check the Services tab.`, 'info');
                addActionToLog(`üìã New contracts available: ${availableContracts.map(c => c.service.name).join(', ')}`, "info");
            }
            
            // Re-render services
            renderServices();
            autoSave();
        }

        function purchaseContractService(serviceId) {
            const service = contractServicesConfig.find(s => s.id === serviceId);
            if (!service) return;
            
            if (gameState.balance < service.purchaseCost) {
                showNotification(`‚ùå Need TTD $${service.purchaseCost.toLocaleString()} to purchase ${service.name}`, 'danger');
                return;
            }
            
            // Deduct purchase cost
            gameState.balance -= service.purchaseCost;
            gameState.dailyExpenses += service.purchaseCost;
            
            // Mark as purchased
            gameState.contractServices[service.id].purchased = true;
            gameState.contractServices[service.id].nextAvailable = Date.now() + CONTRACT_CHECK_INTERVAL;
            
            // Schedule first contract check
            scheduleNextContractCheck(service.id);
            
            addActionToLog(`üõí Purchased ${service.name} for TTD $${service.purchaseCost.toLocaleString()}`, "success");
            showNotification(`‚úÖ Purchased ${service.name}! Contracts will become available every 10 minutes.`, 'success');
            
            updateDashboard();
            renderServices();
            autoSave();
        }

        function acceptContract(serviceId) {
            const serviceState = gameState.contractServices[serviceId];
            if (!serviceState || !serviceState.currentContract) return;
            
            const contract = serviceState.currentContract;
            
            // Check if we can accept more contracts (max 2)
            const activeContracts = getActiveContractsCount();
            if (activeContracts >= 2) {
                showNotification("‚ùå You can only have 2 active contracts at a time. Complete or reject existing contracts first.", 'warning');
                return;
            }
            
            // Update contract status
            contract.status = 'active';
            contract.acceptedAt = Date.now();
            contract.completedAt = Date.now() + CONTRACT_DURATION;
            
            // Update service state
            serviceState.currentContract = null;
            serviceState.activeUntil = Date.now() + CONTRACT_DURATION;
            serviceState.contractHistory.push({
                ...contract,
                status: 'active'
            });
            
            const service = contractServicesConfig.find(s => s.id === serviceId);
            addActionToLog(`‚úÖ Accepted ${service?.name} contract from ${contract.clientName} for TTD $${contract.price.toLocaleString()}`, "success");
            showNotification(`‚úÖ Contract accepted! Service will be active for 4 minutes. Payment: TTD $${contract.price.toLocaleString()}`, 'success');
            
            // Start contract completion timer
            setTimeout(() => {
                completeContract(serviceId);
            }, CONTRACT_DURATION);
            
            updateDashboard();
            renderServices();
            autoSave();
        }

        function rejectContract(serviceId) {
            const serviceState = gameState.contractServices[serviceId];
            if (!serviceState || !serviceState.currentContract) return;
            
            const contract = serviceState.currentContract;
            const service = contractServicesConfig.find(s => s.id === serviceId);
            
            // Update contract status
            contract.status = 'rejected';
            
            // Add to history
            serviceState.contractHistory.push({
                ...contract,
                status: 'rejected'
            });
            
            // Clear current contract
            serviceState.currentContract = null;
            serviceState.nextAvailable = Date.now() + CONTRACT_CHECK_INTERVAL;
            
            addActionToLog(`‚ùå Rejected ${service?.name} contract from ${contract.clientName}`, "warning");
            showNotification(`‚ùå Contract rejected. Next opportunity in 10 minutes.`, 'warning');
            
            // Schedule next check
            scheduleNextContractCheck(serviceId);
            
            updateDashboard();
            renderServices();
            autoSave();
        }

        function completeContract(serviceId) {
            const serviceState = gameState.contractServices[serviceId];
            if (!serviceState) return;
            
            // Find the active contract in history
            const activeContract = serviceState.contractHistory.find(c => 
                c.serviceId === serviceId && c.status === 'active'
            );
            
            if (!activeContract) return;
            
            // Update contract status
            activeContract.status = 'completed';
            activeContract.completedAt = Date.now();
            
            // Make payment
            gameState.balance += activeContract.price;
            gameState.dailyRevenue += activeContract.price;
            
            // Clear active status
            serviceState.activeUntil = null;
            serviceState.nextAvailable = Date.now() + CONTRACT_CHECK_INTERVAL;
            
            const service = contractServicesConfig.find(s => s.id === serviceId);
            addActionToLog(`üí∞ Completed ${service?.name} contract from ${activeContract.clientName}. Payment received: TTD $${activeContract.price.toLocaleString()}`, "success");
            showNotification(`üí∞ Contract completed! Payment received: TTD $${activeContract.price.toLocaleString()}`, 'success');
            
            // Schedule next check
            scheduleNextContractCheck(serviceId);
            
            updateDashboard();
            renderServices();
            autoSave();
        }

        function getActiveContractsCount() {
            let count = 0;
            contractServicesConfig.forEach(service => {
                const serviceState = gameState.contractServices[service.id];
                if (serviceState && serviceState.activeUntil && serviceState.activeUntil > Date.now()) {
                    count++;
                }
            });
            return count;
        }

        function formatTime(ms) {
            const minutes = Math.floor(ms / 60000);
            const seconds = Math.floor((ms % 60000) / 1000);
            return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function showRequirements(serviceId) {
            const service = contractServicesConfig.find(s => s.id === serviceId);
            if (!service) return;
            
            let html = `
                <div class="contract-modal">
                    <h3 style="color: var(--primary); margin-bottom: 1.5rem;">${service.name} Requirements</h3>
                    
                    <div class="contract-grid">
                        <div class="contract-details">
                            <h4 style="color: var(--primary); margin-bottom: 1rem;">Staff Requirements</h4>
                            <ul class="requirements-list">`;
            
            // Staff requirements
            service.requirements.staff.forEach(staffId => {
                const staff = staffConfig.find(s => s.id === staffId);
                const hasStaff = gameState.staff[staffId] && gameState.staff[staffId].hired;
                
                html += `
                    <li>
                        <i class="fas ${hasStaff ? 'fa-check-circle requirement-met' : 'fa-times-circle requirement-not-met'}"></i>
                        ${staff ? staff.name : staffId}
                        ${hasStaff ? '' : ' (Required)'}
                    </li>`;
            });
            
            html += `
                            </ul>
                        </div>
                        
                        <div class="contract-details">
                            <h4 style="color: var(--primary); margin-bottom: 1rem;">Client Requirements</h4>
                            <ul class="requirements-list">`;
            
            // Client requirements
            service.requirements.clients.forEach(clientId => {
                const client = clientSegmentsConfig.find(c => c.id === clientId);
                const hasClient = gameState.clients[clientId] && gameState.clients[clientId].acquired > 0;
                
                html += `
                    <li>
                        <i class="fas ${hasClient ? 'fa-check-circle requirement-met' : 'fa-times-circle requirement-not-met'}"></i>
                        ${client ? client.name : clientId}
                        ${hasClient ? '' : ' (Required)'}
                    </li>`;
            });
            
            html += `
                            </ul>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem;">
                        <h4 style="color: var(--primary); margin-bottom: 1rem;">Pricing by Client</h4>
                        <div class="contract-details">
                            <ul class="requirements-list">`;
            
            // Pricing information
            Object.entries(service.clientPricing).forEach(([clientId, pricing]) => {
                const client = clientSegmentsConfig.find(c => c.id === clientId);
                if (client) {
                    html += `
                        <li>
                            <i class="fas fa-dollar-sign"></i>
                            ${client.name}: TTD $${pricing.min.toLocaleString()} - $${pricing.max.toLocaleString()}
                        </li>`;
                }
            });
            
            html += `
                            </ul>
                        </div>
                    </div>
                    
                    <div style="margin-top: 2rem; text-align: center;">
                        <button class="btn btn-primary" onclick="closeModal('requirementsModal')">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                </div>`;
            
            document.getElementById('requirements-content').innerHTML = html;
            openModal('requirementsModal');
        }

        function showContractHistory(serviceId) {
            const service = contractServicesConfig.find(s => s.id === serviceId);
            const serviceState = gameState.contractServices?.[serviceId];
            
            if (!service || !serviceState) return;
            
            const history = serviceState.contractHistory || [];
            const completed = history.filter(c => c.status === 'completed').length;
            const totalValue = history
                .filter(c => c.status === 'completed')
                .reduce((sum, c) => sum + c.price, 0);
            
            let html = `
                <h3 style="color: var(--primary); margin-bottom: 1.5rem;">${service.name} Contract History</h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                    <div style="background: #f0f9ff; padding: 1rem; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2rem; color: var(--primary); font-weight: bold;">${completed}</div>
                        <div style="color: var(--text-light);">Completed Contracts</div>
                    </div>
                    <div style="background: #f0fff4; padding: 1rem; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2rem; color: var(--success); font-weight: bold;">TTD $${totalValue.toLocaleString()}</div>
                        <div style="color: var(--text-light);">Total Revenue</div>
                    </div>
                    <div style="background: #fefce8; padding: 1rem; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2rem; color: var(--warning); font-weight: bold;">${history.filter(c => c.status === 'rejected').length}</div>
                        <div style="color: var(--text-light);">Rejected Contracts</div>
                    </div>
                </div>`;
            
            if (history.length === 0) {
                html += `
                    <div style="text-align: center; padding: 3rem; color: var(--text-light);">
                        <i class="fas fa-clipboard-list" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                        <p>No contract history yet.</p>
                        <p style="font-size: 0.9rem;">Completed and rejected contracts will appear here.</p>
                    </div>`;
            } else {
                html += `
                    <h4 style="color: var(--primary); margin-bottom: 1rem;">Recent Contracts</h4>
                    <div class="contract-history">`;
                
                // Sort by date (newest first)
                const sortedHistory = [...history].sort((a, b) => b.offeredAt - a.offeredAt).slice(0, 10);
                
                sortedHistory.forEach(contract => {
                    const date = new Date(contract.offeredAt).toLocaleDateString();
                    const statusClass = contract.status === 'completed' ? 'success' : 
                                      contract.status === 'rejected' ? 'rejected' : 'completed';
                    
                    html += `
                        <div class="history-entry ${statusClass}">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.3rem;">
                                <strong>${contract.clientName}</strong>
                                <span style="color: ${contract.status === 'completed' ? 'var(--success)' : 'var(--danger)'};">
                                    ${contract.status === 'completed' ? 'TTD $' + contract.price.toLocaleString() : contract.status.toUpperCase()}
                                </span>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-light);">
                                <span>${date}</span>
                                <span>${contract.status === 'completed' ? 'Completed' : 
                                       contract.status === 'rejected' ? 'Rejected' : 'Active'}</span>
                            </div>
                        </div>`;
                });
                
                html += `</div>`;
            }
            
            html += `
                <div style="margin-top: 2rem; text-align: center;">
                    <button class="btn btn-primary" onclick="closeModal('historyModal')">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>`;
            
            document.getElementById('history-content').innerHTML = html;
            openModal('historyModal');
        }

        
        // ============================================
        // INITIALIZATION
        // ============================================

        // Initialize
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabName = tab.getAttribute('data-tab');
                openTab(tabName);
            });
        });

        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        };


// ============================================
// FINANCIAL REPORTING SYSTEM - NEW FUNCTIONS
// ============================================

// 1. Initialize financial ledger
function initFinancialLedger() {
    if (!gameState.financialLedger) {
        gameState.financialLedger = [];
    }
    if (!gameState.dailyTransactionLog) {
        gameState.dailyTransactionLog = {};
    }
    if (!gameState.dailyTransactionLog[gameState.gameDay]) {
        gameState.dailyTransactionLog[gameState.gameDay] = [];
    }
}

// 2. Log a transaction
function logTransaction(transaction) {
    initFinancialLedger();
    
    const fullTransaction = {
        id: Date.now(),
        gameDay: gameState.gameDay,
        timestamp: new Date().toISOString(),
        realTimestamp: Date.now(),
        ...transaction
    };
    
    gameState.financialLedger.unshift(fullTransaction);
    
    if (!gameState.dailyTransactionLog[gameState.gameDay]) {
        gameState.dailyTransactionLog[gameState.gameDay] = [];
    }
    gameState.dailyTransactionLog[gameState.gameDay].push(fullTransaction);
    
    // Keep only last 7 days
    const daysToKeep = Object.keys(gameState.dailyTransactionLog)
        .map(Number)
        .sort((a, b) => b - a)
        .slice(0, 7);
    
    const newDailyLog = {};
    daysToKeep.forEach(day => {
        newDailyLog[day] = gameState.dailyTransactionLog[day];
    });
    gameState.dailyTransactionLog = newDailyLog;
    
    // Keep ledger to 500 transactions max
    if (gameState.financialLedger.length > 500) {
        gameState.financialLedger = gameState.financialLedger.slice(0, 500);
    }
}
// 3. Calculate accounting fees
function calculateAccountingFees() {
    let dailyFee = 0;
    
    if (!gameState.staff.cfo || !gameState.staff.cfo.hired) {
        dailyFee = 5000; // Without CFO
    } else {
        const cfoSalary = gameState.staff.cfo.currentSalary || 90000;
        dailyFee = (cfoSalary * 0.20) / 365; // With CFO
    }
    
    return dailyFee;
}

// 4. Apply accounting fees (call this in resetDaily())
function applyAccountingFees() {
    const dailyFee = calculateAccountingFees();
    
    if (dailyFee > 0 && gameState.balance >= dailyFee) {
        gameState.balance -= dailyFee;
        gameState.dailyExpenses += dailyFee;
        
        logTransaction({
            type: 'accounting_fee',
            amount: -dailyFee,
            description: `Accounting fees for Day ${gameState.gameDay}`,
            category: 'operating_expense'
        });
        
        addActionToLog(`üíº Accounting fees: TTD $${dailyFee.toLocaleString('en-US', {minimumFractionDigits: 2})}`, "info");
    } else if (dailyFee > 0) {
        logTransaction({
            type: 'accounting_fee_unpaid',
            amount: -dailyFee,
            description: `Unpaid accounting fees for Day ${gameState.gameDay}`,
            category: 'operating_expense'
        });
    }
}

// 5. Generate financial report
function generateFinancialReport(day) {
    const transactions = gameState.dailyTransactionLog[day] || [];
    
    let report = {
        day: day,
        totalRevenue: 0,
        totalExpenses: 0,
        transactions: transactions,
        categories: {
            revenue: 0,
            operating_expense: 0,
            staff_cost: 0,
            client_cost: 0,
            other: 0
        }
    };
    
    // Calculate totals
    transactions.forEach(t => {
        const amount = t.amount || 0;
        if (amount > 0) {
            report.totalRevenue += amount;
        } else {
            report.totalExpenses += Math.abs(amount);
        }
        
        // Categorize
        const category = t.category || 'other';
        report.categories[category] = (report.categories[category] || 0) + Math.abs(amount);
    });
    
    report.netIncome = report.totalRevenue - report.totalExpenses;
    return report;
}

// 6. Display report in the new tab
function displayFinancialReport(report) {
    // This would create the 4-section report display
    // You'd implement this based on your UI preferences
    console.log("Financial Report for Day", report.day);
    console.log("Revenue:", report.totalRevenue);
    console.log("Expenses:", report.totalExpenses);
    console.log("Net Income:", report.netIncome);
}



// ============================================
// FINANCIAL REPORT DISPLAY FUNCTIONS
// ============================================

let currentReportDay = 1;

// Generate and display financial report
function generateFinancialReport(day) {
    const transactions = gameState.dailyTransactionLog[day] || [];
    
    // Calculate report data
    let reportData = {
        day: day,
        totalRevenue: 0,
        totalExpenses: 0,
        transactions: transactions,
        categories: {
            revenue: 0,
            operating_expense: 0,
            staff_cost: 0,
            client_cost: 0,
            other: 0
        },
        accountingFees: 0,
        terminationCosts: 0,
        salaryExpenses: 0,
        staffHiringCosts: 0  // FIXED: Added comma on previous line
    };
    
    // Process transactions
    transactions.forEach(transaction => {
        const amount = transaction.amount || 0;
        
        if (amount > 0) {
            reportData.totalRevenue += amount;
        } else {
            reportData.totalExpenses += Math.abs(amount);
        }
        
        // Categorize
        const category = transaction.category || 'other';
        reportData.categories[category] = (reportData.categories[category] || 0) + Math.abs(amount);
        
        // Special tracking
        if (transaction.type === 'accounting_fee' || transaction.type === 'accounting_fee_unpaid') {
            reportData.accountingFees += Math.abs(amount);
        } else if (transaction.type === 'termination_cost' || transaction.type === 'executive_termination') {
            reportData.terminationCosts += Math.abs(amount);
        } else if (transaction.type === 'salary_payment') {
            reportData.salaryExpenses += Math.abs(amount);
        } else if (transaction.type === 'staff_hiring_cost' || transaction.type === 'executive_hiring') {  // FIXED: Removed extra }
            // ADD THIS - track staff hiring separately
            reportData.staffHiringCosts = (reportData.staffHiringCosts || 0) + Math.abs(amount);
        }
    });
    
    reportData.netIncome = reportData.totalRevenue - reportData.totalExpenses;
    
    return reportData;
}

// Display report in the tab
function displayFinancialReport(day) {
    const reportData = generateFinancialReport(day);
    const reportContent = document.getElementById('report-content');
    
    if (!reportContent) return;
    
    // Sim Companies inspired styling
    let html = `
        <div class="sc-header" style="background: linear-gradient(135deg, #2c3e50 0%, #4a6491 100%); color: white; padding: 15px 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 10px; border-radius: 6px;">
                        <i class="fas fa-file-invoice-dollar" style="font-size: 24px;"></i>
                    </div>
                    <div>
                        <h3 style="margin: 0; font-size: 20px; font-weight: 600;">Financial Report</h3>
                        <div style="display: flex; gap: 10px; margin-top: 5px; font-size: 14px;">
                            <span style="background: rgba(255,255,255,0.15); padding: 3px 8px; border-radius: 4px;">
                                <i class="fas fa-calendar-day"></i> Day ${day}
                            </span>
                            <span style="background: rgba(255,255,255,0.15); padding: 3px 8px; border-radius: 4px;">
                                <i class="fas fa-building"></i> ${gameState.companyName || 'Your Company'}
                            </span>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="sc-button sc-button-secondary" onclick="changeReportDay(-1)" style="min-width: 100px;">
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <button class="sc-button sc-button-secondary" onclick="changeReportDay(1)" style="min-width: 100px;">
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    `;
    
    if (reportData.transactions.length === 0) {
        html += `
            <div class="sc-card" style="text-align: center; padding: 40px 20px; background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                <div style="font-size: 48px; color: #b0b0b0; margin-bottom: 20px;">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h4 style="color: #7f8c8d; margin-bottom: 10px;">No Financial Data Available</h4>
                <p style="color: #95a5a6;">No transactions recorded for Day ${day}</p>
                <div style="margin-top: 20px; font-size: 14px; color: #95a5a6;">
                    <i class="fas fa-info-circle"></i> Financial data will appear after transactions occur
                </div>
            </div>
        `;
    } else {
        // Sim Companies style sections
        html += `
            <div class="sc-card" style="background: white; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); overflow: hidden;">
                <div class="sc-card-header" style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="background: #3498db; color: white; width: 32px; height: 32px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-receipt"></i>
                        </div>
                        <h4 style="margin: 0; font-weight: 600; color: #2c3e50;">Transaction Ledger</h4>
                    </div>
                    <span style="font-size: 14px; color: #7f8c8d; margin-left: auto;">
                        ${reportData.transactions.length} transactions
                    </span>
                </div>
                <div style="max-height: 400px; overflow-y: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa; border-bottom: 2px solid #e9ecef;">
                                <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #2c3e50; font-size: 13px;">TIME</th>
                                <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #2c3e50; font-size: 13px;">TYPE</th>
                                <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #2c3e50; font-size: 13px;">DESCRIPTION</th>
                                <th style="padding: 12px 15px; text-align: left; font-weight: 600; color: #2c3e50; font-size: 13px;">AMOUNT</th>
                            </tr>
                        </thead>
                        <tbody>
        `;
        
        reportData.transactions.forEach((transaction, index) => {
            const time = new Date(transaction.timestamp).toLocaleTimeString([], { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            const amount = transaction.amount || 0;
            const amountColor = amount > 0 ? '#27ae60' : amount < 0 ? '#e74c3c' : '#95a5a6';
            const amountDisplay = amount > 0 ? 
                `+$${amount.toLocaleString('en-US', {minimumFractionDigits: 2})}` : 
                `-$${Math.abs(amount).toLocaleString('en-US', {minimumFractionDigits: 2})}`;
            const type = transaction.type || 'N/A';
            
            // Sim Companies style for transaction types
            const getTypeIcon = (type) => {
                const icons = {
                    'sales': 'fa-shopping-cart',
                    'salary_payment': 'fa-user-tie',
                    'accounting_fee': 'fa-calculator',
                    'client_acquisition': 'fa-handshake',
                    'default': 'fa-exchange-alt'  // FIXED: Added default icon
                };
                return icons[type] || icons.default;
            };
            
            html += `
                <tr style="border-bottom: 1px solid #f1f5f9; background: ${index % 2 === 0 ? '#fff' : '#f8f9fa'};">
                    <td style="padding: 12px 15px; font-size: 13px; color: #7f8c8d;">${time}</td>
                    <td style="padding: 12px 15px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #3498db;">
                                <i class="fas ${getTypeIcon(type)}"></i>
                            </span>
                            <span style="font-size: 13px; color: #2c3e50; text-transform: capitalize;">
                                ${type.replace(/_/g, ' ')}
                            </span>
                        </div>
                    </td>
                    <td style="padding: 12px 15px; font-size: 13px; color: #2c3e50; max-width: 300px;">
                        ${transaction.description || 'No description'}
                    </td>
                    <td style="padding: 12px 15px; font-weight: 600; color: ${amountColor}; font-size: 13px; text-align: right;">
                        ${amountDisplay}
                    </td>
                </tr>
            `;
        });
        
        html += `
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                <div class="sc-card" style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                    <div class="sc-card-header" style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="background: #2ecc71; color: white; width: 32px; height: 32px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h4 style="margin: 0; font-weight: 600; color: #2c3e50;">Income Statement</h4>
                        </div>
                    </div>
                    <div style="padding: 20px;">
                        <div class="sc-stat-row" style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                            <span style="font-size: 14px; color: #7f8c8d;">Total Revenue</span>
                            <span style="font-weight: 600; color: #27ae60; font-size: 16px;">
                                $${reportData.totalRevenue.toLocaleString('en-US', {minimumFractionDigits: 2})}
                            </span>
                        </div>
                        <div class="sc-stat-row" style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                            <span style="font-size: 14px; color: #7f8c8d;">Total Expenses</span>
                            <span style="font-weight: 600; color: #e74c3c; font-size: 16px;">
                                $${reportData.totalExpenses.toLocaleString('en-US', {minimumFractionDigits: 2})}
                            </span>
                        </div>
                        <div class="sc-stat-row" style="display: flex; justify-content: space-between; padding: 15px 0; background: #f8f9fa; margin: 0 -20px; padding: 15px 20px; border-top: 2px solid #e9ecef; border-bottom: 2px solid #e9ecef;">
                            <span style="font-weight: 600; color: #2c3e50; font-size: 15px;">Net Income</span>
                            <span style="font-weight: 700; color: ${reportData.netIncome >= 0 ? '#27ae60' : '#e74c3c'}; font-size: 18px;">
                                $${reportData.netIncome.toLocaleString('en-US', {minimumFractionDigits: 2})}
                            </span>
                        </div>
                    </div>
                </div>
                
                <div class="sc-card" style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                    <div class="sc-card-header" style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="background: #e74c3c; color: white; width: 32px; height: 32px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <h4 style="margin: 0; font-weight: 600; color: #2c3e50;">Expense Breakdown</h4>
                        </div>
                    </div>
                    <div style="padding: 20px;">
        `;
        
        // Expense breakdown items
        const expenses = [
            { label: 'Salaries & Wages', value: reportData.salaryExpenses, icon: 'fa-user-tie', color: '#3498db' },
            { label: 'Accounting Fees', value: reportData.accountingFees, icon: 'fa-calculator', color: '#9b59b6' },
            { label: 'Termination Costs', value: reportData.terminationCosts, icon: 'fa-user-slash', color: '#e67e22' },
            { label: 'Client Acquisition', value: reportData.categories.client_cost, icon: 'fa-handshake', color: '#1abc9c' },
            { label: 'Staff Hiring Costs', value: reportData.staffHiringCosts, icon: 'fa-user-plus', color: '#f39c12' }  // FIXED: Added comma on previous line
        ];
        
        expenses.forEach(expense => {
            if (expense.value > 0) {
                html += `
                    <div class="sc-expense-item" style="display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f1f5f9;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="background: ${expense.color}; color: white; width: 28px; height: 28px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas ${expense.icon}" style="font-size: 12px;"></i>
                            </div>
                            <span style="font-size: 13px; color: #2c3e50;">${expense.label}</span>
                        </div>
                        <span style="font-weight: 600; color: #e74c3c; font-size: 14px;">
                            $${expense.value.toLocaleString('en-US', {minimumFractionDigits: 2})}
                        </span>
                    </div>
                `;
            }
        });
        
        html += `
                    </div>
                </div>
            </div>
            
            <div class="sc-card" style="background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                <div class="sc-card-header" style="background: #f8f9fa; padding: 15px 20px; border-bottom: 1px solid #e9ecef;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div style="background: #9b59b6; color: white; width: 32px; height: 32px; border-radius: 6px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <h4 style="margin: 0; font-weight: 600; color: #2c3e50;">Financial Ratios</h4>
                    </div>
                </div>
                <div style="padding: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        `;
        
        // Financial ratios
        const profitMargin = reportData.totalRevenue > 0 ? (reportData.netIncome / reportData.totalRevenue * 100) : 0;
        const revenuePerTx = reportData.totalRevenue / reportData.transactions.length;
        const expenseRatio = reportData.totalRevenue > 0 ? (reportData.totalExpenses / reportData.totalRevenue * 100) : 0;
        
        const ratios = [
            { 
                label: 'Profit Margin', 
                value: `${profitMargin.toFixed(1)}%`,
                color: profitMargin >= 20 ? '#27ae60' : profitMargin >= 0 ? '#f39c12' : '#e74c3c',
                icon: 'fa-chart-pie'
            },
            { 
                label: 'Avg. Transaction', 
                value: `$${revenuePerTx.toLocaleString('en-US', {minimumFractionDigits: 2})}`,
                color: '#3498db',
                icon: 'fa-exchange-alt'
            },
            { 
                label: 'Expense Ratio', 
                value: `${expenseRatio.toFixed(1)}%`,
                color: expenseRatio < 50 ? '#2ecc71' : expenseRatio < 80 ? '#f39c12' : '#e74c3c',
                icon: 'fa-chart-bar'
            }
        ];
        
        ratios.forEach(ratio => {
            html += `
                <div class="sc-ratio-card" style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="color: ${ratio.color}; font-size: 24px; margin-bottom: 8px;">
                        <i class="fas ${ratio.icon}"></i>
                    </div>
                    <div style="font-size: 12px; color: #7f8c8d; margin-bottom: 5px;">
                        ${ratio.label}
                    </div>
                    <div style="font-weight: 700; color: ${ratio.color}; font-size: 18px;">
                        ${ratio.value}
                    </div>
                </div>
            `;
        });
        
        html += `
                    </div>
                </div>
            </div>
        `;
    }
    
    // Add CSS for Sim Companies theme
    html += `
        <style>
            .sc-button {
                padding: 10px 20px;
                border: none;
                border-radius: 6px;
                font-weight: 600;
                cursor: pointer;
                font-size: 14px;
                transition: all 0.2s;
            }
            
            .sc-button-secondary {
                background: white;
                color: #2c3e50;
                border: 1px solid #dfe6e9;
            }
            
            .sc-button-secondary:hover {
                background: #f8f9fa;
                border-color: #bdc3c7;
            }
            
            .sc-card {
                transition: transform 0.2s, box-shadow 0.2s;
            }
            
            .sc-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            }
            
            .sc-stat-row:hover {
                background: #f8f9fa;
            }
        </style>
    `;
    
    reportContent.innerHTML = html;
    currentReportDay = day;
}

// Change report day
function changeReportDay(delta) {
    const newDay = currentReportDay + delta;
    
    if (newDay >= 1 && newDay <= gameState.gameDay) {
        displayFinancialReport(newDay);
    } else {
        showNotification(`No financial data available for Day ${newDay}`, "warning");
    }
}

// Auto-display report when opening Reports tab
function setupReportsTab() {
    const reportsTab = document.querySelector('.tab[data-tab="reports"]');
    if (reportsTab) {
        reportsTab.addEventListener('click', function() {
            const reportDay = gameState.gameDay > 1 ? gameState.gameDay - 1 : 1;
            setTimeout(() => {
                displayFinancialReport(reportDay);
            }, 100);
        });
    }
}
        window.onload = initGame;
    </script>

</body></html>